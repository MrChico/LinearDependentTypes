\input{../preamble.tex}
\usepackage[margin=0.5in]{geometry}
%\newtheorem{defn}[thm]{Definition}
\newtheorem{lemm}[thm]{Lemma}
%\newtheorem{cor}[thm]{Corollary}
%\newtheorem{prop}[thm]{Proposition}
\newtheorem{remrk}[thm]{Remark}
\newtheorem{corl}[thm]{Corollary}
%\newtheorem{ill}[thm]{Illustration}
\newtheorem{expl}[thm]{Example}
\begin{document}
\title{Models of linear dependent type theory}
\author{Martin Lundfall}
\maketitle
\abstract
The role that types play in type theory can be seen as a simoultaneous generalisation of the concept of a set, proposition and data type. In linear type theory, this view can be extended by interpreting linear types as a particular kind of resource that is \textit{consumed} in the derivation. In this paper, we construct a type theory in which we distinguish between non-linear, dependent types (what we will call \textit{cartesian}), and linear types, where both constructs are allowed to depend on terms of cartesian types. In the interplay between the cartesian and linear types we develop two new type formers, $\sqcap_{x : A}B$ and $\sqsubset_{x : A}B$, with rules similar to $\Pi$ and $\Sigma$, but where the dependent type $B$ (and therefore the resulting construct) is linear. The $!$-exponential from linear logic is deconstructed into two operators, $M$ and $L$, allowing a transformation of linear types into cartesian and vice versa. We construct a semantic framework where the type theory is interpreted by constructing a base category of cartesian contexts equipped with two fibrations, whose fibers over a context $\Gamma$ give rise to the categories of linear and cartesian types in $\Gamma$. The operators $M$ and $L$ give rise to a fiberwise adjunction between these.
\newpage
\tableofcontents
\newpage
\section{TODO}
Change proofs of syntactic functor using new $L-U$.
$L$, $M$ and universe semantic type formers.\\
Disclaimer about coherence issues.\\
Another model: $q : Mon(Gph) \to Set$ (and sets with families)
Let $\mathcal{L}$ be a (monoidal?) (2,1)-category. For $A, B \in \mathcal{L}_{\Gamma}$, can one define the type $f =_{[A, B]} g$ to consist of the 2-cells between f and g?\\
Examples of such categories:\\
Cat (with natural iso)\\
Grp\\
SMC\\
Kelly's enriched categories for more on enriched cats\\
%\section{Introduction}
\section{Preliminaries}
The paper is largely split into two sections; syntax and semantics. 
Familiarity with basic category theoretic concepts like limits, adjoints, monoidal categories is assumed.
\subsection{Dependent type theory}
A \textit{type} is a syntactic construction whose meaning and function stems from the ways in which it interacts with the derivation rules of a \textit{type theory}. Approaching type theory from the perspective of logic, we can form a first approximation of the definition of a type as a generalization of a proposition and a set.
\subsection{Linear type theory}
Linear logic is a substructural logic in which the rules of weakening and contraction:
\[
  \begin{split}
    \inference{\Gamma, \Delta \vdash B}{\Gamma, A, \Delta \vdash B}[Weak] \quad \quad 
    \inference{\Gamma, A, A, \Delta \vdash B}{\Gamma, A, \Delta \vdash B}[Contr]
    \end{split}
\]
are not admissable.\\
In other words, assumptions cannot be freely assumed or dismissed; they must be used exactly once in the conclusion. In linear logic, we are inclined to think of a sequent $A_1, A_2, \dots, A_n \vdash B$ as modelling a function or process in which the assumptions $A_1, A_2, \dots A_n$ are \textit{resources used} to yield $B$. As a first, toy example, we consider the chemical process of burning hydrogen:
%\begin{comment}
\begin{expl}\label{burn}
Consider the following primitive derivation rule: 
\[
  O_2 \otimes H_2 \otimes H_2 \vdash H_2O \otimes H_2O
\]
stating that given an oxygen molecule and two hydrogen molecules, burning yields two water molecules. If weakening was admissable, we would be able to assume an additional hydrogen molecule without changes the antecedent, which does not make sense under the resource interpretation of linear logic.\\
\end{expl}
%\end{comment}
Just as inuitionistic logic naturally extends to (dependent) type theory under the slogan of propositions as types, linear logic can be extended to a linear type theory, where sequents are decorated with proof terms:
\[
  x_1 : A_1, x_2 : A_2, \dots x_n : A_n \vdash t : B
\]
and here linearity implies that the free variables of $t$ are $x_1, x_2, \dots x_n$, each appearing exactly once.\\
Interest in linear type theory stems from disparate sources. From the perspective of (classical) computer science, it can be used for modelling state and storage, with linear variables denoting resources like pointers or files \cite{krishnaswami}, or even as a theoretical description of the resource handling of a blockchain \cite{meredith2015linear}. In quantum physics, linear types respect the no cloning theorem of quantum states, and are also proposed as a syntax for quantum computation \cite{duncan2006types}. From a semantic perspective, linear type theory can be interpreted in a symmetric monoidal closed categories, generalising the structure of a cartesian closed categories in which (non-dependent) type theories are interepreted.\\

\input{fibrations}
\subsection{Enriched and higher categories}
The concept of a category can be generalized in a few different directions. In exploring semantics of linear type theory, our first encounter with such structures will be  enriched categories, where hom-sets are generalized to ``hom-objects'' of a monoidal category $\mathcal{V}$.
\begin{defn}\label{enr-cat}
  For a monoidal category $\mathcal{V}$, a \textbf{$\mathcal{V}$-enriched category} $\mathcal{C}$, consists of the following:
  \begin{enumerate}
  \item A set $\mathcal{C}_0$ of objects,
  \item for each pair $a, b \in \mathcal{C}_0$, an object $V_{a,b} \in \mathcal{V}$,
  \item for every $a, b, c \in \mathcal{C}_0$, a \textit{composition law}, i.e. a functor $M_{a, b, c} : V_{b, c} \otimes V_{a, b} \to V_{a, c}$ and
  \item an identity element $j_a : I \to V_{a, a}$
\end{enumerate}
such that for all $a, b, c, d$, the following associativity and identity diagrams commute:
    \[
      \ti
      (V_{c, d} \otimes V_{b, c}) \otimes V_{a, b} \ar[d, "{M_{b, c, d} \otimes 1_{V_{a,b}}}"] \ar[rr, "\alpha"] & & V_{c, d} \otimes (V_{b, c} \otimes V_{a, b}) \ar[d, "{1_{V_{c,d}} \otimes M_{a, b, c}}"]\\
      V_{b, d} \otimes V_{a, b} \ar[rd, "M_{a, b, d}"] & & V_{c, d} \otimes V_{a, c} \ar[ld, "M_{a, c, d}"]\\
      & V_{a, d}      &
      \kz
    \]
    \[
      \ti
      I \otimes V_{a, b} \ar[d, "j_b \otimes 1_{V_{a, b}}", swap] \ar[r, "l"] & V_{a, b} & V_{a, b} \otimes I \ar[l, "r"] \ar[d, "1_{V_{a, b}} \otimes j_a"] \\
      V_{b, b} \otimes V_{a, b} \ar[ru, "M_{a, b, b}"] & & V_{a, b} \otimes V_{a, a} \ar[lu, "M_{a, a, b}"]
      \kz
    \]
    where $a$, $l$ and $r$ are the associator, and left and right unitor ismorphisms associated with the monoidal structure of $\mathcal{V}$.
\end{defn}
Note that for the special case of $\mathcal{V} = Set$ we get back the definition of a category. Plenty of examples of constructions in enriched categories can be found in the comprehensive introduction \textit{Basic concepts of enriched category theory} by Max Kelly, \cite{kelly}.\\
Another generalization of a category is suggested by the direction in which categories generalize sets/classes by allowing arrows between objects. Thinking of arrows as one-dimensional objects between zero-dimensional objects, one can imagine the existence of 2-dimensional arrows between 1-dimensional ones. This leads to the notion of a 2-category. These come in two different forms, strict 2-categories (or just 2-categories) or weak 2-categories (also known as bicategories). Equipped with the notion of an enriched category, strict 2-categories can be defined concisely as:
\begin{defn}
  A \textbf{(strict) 2-category} is a $Cat$-enriched category.
\end{defn}
Breaking down this definition provides a more illuminating view. A strict 2-category, $\mathcal{C}$, consists of
\begin{itemize}
\item a collection of objects $\mathcal{C}_0$,
\item for any pair of objects $a, b \in \mathcal{C}_0$, a category $C_{a, b}$, whose objects will be called ``1-morphisms'' and whose morphisms are renamed ``2-morphisms''.
\item for any object $a \in \mathcal{C}_0$, an ``identity'' functor $1_a : \mathbf{1} \to \mathcal{C}_{a, a}$, 
\item for any triple of objects $a, b, c \in \mathcal{C}_0$, a functor $Comp : C_{b, c} \times C_{a, b} \to C_{a, c}$
  satisfying the associativity and identity diagrams from the definition of enriched categories.
\end{itemize}
The action of $Comp$ on 1-morphisms is called ``horizontal composition'' and is written $gf := Comp(g, f)$ for $f \in \mathcal{C}_{a, b}$ and $g \in \mathcal{C}_{b, c}$, whereas the composition between 2-morphisms $\alpha : f \implies g$, $\alpha' : g \implies h$ for $f, g, h \in \mathcal{C}_{a, b}$ is written $\alpha' \circ \alpha$.
Thanks to the functoriality of $Comp$, these satisfy the following \textit{interchange law}:
\[
  (\beta' \circ \beta)(\alpha'\circ \alpha)=(\beta'\alpha')\circ(\beta\alpha)
\]\\
The path from strict 2-categories to weak 2-categories is marched to the category theoretic slogan that it is undesirable to speak of equality between objects in a category. 2-morphisms give us a way of relating 1-morphisms up to isomorphism instead of on-the-nose equality. Thus we are inclined to loosen the restriction of the associativity and unital diagrams in the definition of a 2-category to only commute up to coherent natural isomorphism:
\begin{defn}
  A \textbf{weak 2-category} $\mathcal{C}$ is a collection of objects, 1-morphisms and 2-morphisms with composition and identity functors as before, such that for all $a, b, c, d \in \mathcal{C}_0$, there exists natural isomorphisms
  \[
    \gamma :  M_{a,b,d} \circ (M_{b,c,d} \otimes 1_{V_{a,b}}) \implies M_{a, c, d} \circ (1_{V_{c, d}} \otimes M_{a, b, c}) \circ a
  \]
  \[
    \lambda : l \implies M_{a, b, b} \circ (j_b \circ 1_{V_{a,b}})
  \]
  \[
    \rho : r \implies M_{a, a, b} \circ (1_{V_{a,b}} \circ j_a)
  \]
  in other words, associated with the diagrams:
  \[
    \ti
    (V_{c, d} \otimes V_{b, c}) \otimes V_{a, b} \ar[d, "{M_{b, c, d} \otimes 1_{V_{a,b}}}"] \ar[rr, "\alpha"] & & V_{c, d} \otimes (V_{b, c} \otimes V_{a, b}) \ar[d, "{1_{V_{c,d}} \otimes M_{a, b, c}}"]\\
    V_{b, d} \otimes V_{a, b} \ar[rd, "M_{a, b, d}"] \ar[rr, "\gamma", Rightarrow, shorten <=50pt,shorten >=50pt]& & V_{c, d} \otimes V_{a, c} \ar[ld, "M_{a, c, d}"]\\
    & V_{a, d}      &
    \kz
  \]
  \[
    \ti
    I \otimes V_{a, b} \ar[d, "j_b \otimes 1_{V_{a, b}}", swap] \ar[d, "\lambda", Rightarrow, xshift=30pt, shorten <=10pt,shorten >=10pt, yshift=7pt] \ar[r, "l"] & V_{a, b} & V_{a, b} \otimes I \ar[l, "r"] \ar[d, "1_{V_{a, b}} \otimes j_a"] \ar[d, "\rho", Rightarrow, xshift=-30pt, shorten <=10pt,shorten >=10pt, yshift=7pt] \\
    V_{b, b} \otimes V_{a, b} \ar[ru, "M_{a, b, b}",swap] & & V_{a, b} \otimes V_{a, a} \ar[lu, "M_{a, a, b}"]
    \kz
  \]
  subject to the following coherence conditions:
\end{defn}


%\subsection{Spectra}
%\input{spectra}
\section{Syntax}
The particular linear dependent type theory under consideration is a inspired by the work of Krishnaswami in \cite{krishnaswami} and Vákár in \cite{vakar14}. Types are either \textit{cartesian}, in which case we simply write $\Gamma \vdash A \text{ type}$, or \textit{linear}, written $\Gamma \vdash A \text{ linear}$. When making typing judgements of linear terms, contexts will be split into two parts, separated by a semicolon. The first part contains \textit{cartesian} assumptions, for which weakening and contraction is allowed, while the second part is the \textit{linear} part, containing ephemeral assumptions that we are also inclined to think of as resources. The derivation rules for linear types will force the linear variables to occur exactly once in the conclusion. Dependent types are restricted to only depend on terms of cartesian types. 
\subsection{Structural rules}
We will be dealing with the following judgements:\\
\begin{figure}[h]
\fbox{
\begin{minipage}{.5\linewidth}
\textbf{Judgement:}\\
$\vdash \Gamma \text{ ctxt}$\\
$\vdash \Gamma; \Xi \text{ ctxt}$\\
$\Gamma \vdash A \text{ type}$\\
$\Gamma \vdash A \text{ linear}$\\
$\Gamma \vdash M : A$\\
$\Gamma; \Xi \vdash M : A$\\
$\Gamma \vdash A \equiv A' \text{ type}$\\
$\Gamma \vdash A \equiv A' \text{ linear}$\\
$\Gamma \vdash M \equiv N : A$\\
$\Gamma; \Xi \vdash x \equiv y : A$
\end{minipage}
\begin{minipage}{.5\linewidth}
\textbf{Meaning:}\\
$\Gamma$ is a well-formed cartesian context.\\
$\Gamma; \Xi$ is a well-formed mixed context\\
$A$ is a cartesian type in $\Gamma$\\
$A$ is a linear type in $\Gamma$\\
$M$ is a term of the cartesian type $A$ in $\Gamma$\\
$M$ is a (linear) term of the linear type $A$ in $\Gamma; \Xi$\\
$A$ and $A'$ are equal cartesian types in $\Gamma$\\
$A$ and $A'$ are equal linear types in $\Gamma; \Xi$\\
$M$ and $N$ are equal cartesian terms of $A$ in $\Gamma$\\
$x$ and $y$ are equal linear terms of $A$ in $\Gamma; \Xi$
\end{minipage}}
\caption{Judgements of linear dependent type theory}
\label{judgements}
\end{figure}
\\
The basic structural rules for the linear dependent type theory are given in \ref{struc}. Omitted are the rules concerning judgemental equality, which specify that it is an equality relation which is congruent with respect to the other structural rules.
\begin{figure}[H]
  \centering
  \input{struc}
  \caption{Structural rules}
  \label{struc}
\end{figure}
$\mathcal{J}$ denotes a judgement of the form $A \text{ type}$, $A \text{ linear}$ or $M : A$ (for a cartesian type $A$).
\subsection{Cartesian typing rules}
The cartesian types that we will use are the standard $\Pi$, $\Sigma$ and $Id$-types. For $\Sigma$ and $Id$ we will introduce an extra elimination and computational rule for the case where the type being eliminated into is linear.\\
\begin{figure}[H]
\fbox{
\begin{minipage}{.5\linewidth}
\[
\inference{\Gamma \vdash A \type \quad \Gamma, x : A \vdash B \type}
{\Gamma \vdash \Pi_{x : A}B \type}[$\Pi$-F]
\]\\
\[
\inference{\Gamma, x : A \vdash b : B}
{\Gamma \vdash \lambda x.b : \Pi_{x : A}B}[$\Pi$-I]
\]\\
\[
\inference{\Gamma \vdash t : \Pi_{x : A}B \type\\
\Gamma \vdash M : A}
{\Gamma \vdash t(M) : B[M/x]}[$\Pi$-E]
\]\\
\[
\inference{\Gamma, x : A \vdash b : B \quad \Gamma \vdash M : A}
{\Gamma \vdash \lambda x. b(M) \equiv b[M/x] : B[M/x]}[$\Pi$-C]
\]\\
\[
\inference{\Gamma \vdash A \type \quad \Gamma, x : A \vdash B \type}
{\Gamma \vdash \Sigma_{x : A}B \type}[$\Sigma$-F]
\]\\
\[
\inference{\vdash \Gamma \text{ ctxt}}{\Gamma \vdash 1 \type}[1-F]
\]\\
\[
\inference{\Gamma \text{ ctxt}}{\Gamma \vdash \star : 1}[1-I]
\]\\
\[
  \inference{\Gamma, x : 1 \vdash C \type \quad \Gamma \vdash c : C[\star/x]\quad  \Gamma \vdash M : 1}
  {\Gamma \vdash \hat c[M] : C[M/x]}[1-E]
\]\\
\end{minipage}
\begin{minipage}{.5\linewidth}
\[
\inference{\Gamma \vdash M : A \quad \Gamma \vdash N : B[M/x]}
{\Gamma \vdash (M, N) : \Sigma_{x : A}B}[$\Sigma$-I]
\]\\
\[
\inference{\Gamma, t : \Sigma_{x : A}B \vdash C \type\\
\Gamma, x : A, y : B \vdash c : C[(x, y)/t]\\
\Gamma \vdash s : \Sigma_{x : A}B}
{\Gamma \vdash \hat c[s] : C[s/t]}[$\Sigma-$E$_1$]
\]\\
\[
  \inference{\Gamma, t : \Sigma_{x : A}B \vdash C \linear\\
\Gamma, x : A, y : B; \Xi \vdash c : C[(x, y)/t]\\
\Gamma \vdash s : \Sigma_{x : A}B}
{\Gamma; \Xi[pr_1(s)/x][pr_2(s)/y] \vdash \hat c[s] : C[s/t]}[$\Sigma$-E$_2$]
\]\\
\[
\inference{\Gamma \vdash \hat c[(a, b)] : C[(a, b)/t]}
{\Gamma \vdash \hat c[(a, b)] \equiv c[(a, b)/t] : C[(a, b)/t]}[$\Sigma$-C$_1$]
\]\\
\[
\inference{\Gamma; \Xi \vdash \hat c[(a, b)] : C[(a, b)/t]}
{\Gamma; \Xi \vdash \hat c[(a, b)] \equiv c[(a, b)/t] : C[(a, b)/t]}[$\Sigma$-C$_2$]
\]\\
\[
  \inference{\Gamma \vdash \hat c[\star] : C[\star/x]}
  {\Gamma \vdash \hat c[\star] \equiv c[\star/x] : C[\star/x]}[1-C]
\]\\
\end{minipage}
}
\caption{(Cartesian) dependent sum and product types}
\label{sigmaPi}
\end{figure}
\begin{figure}[H]
\fbox{
\begin{minipage}{.37\linewidth}
\[
\inference{\Gamma \vdash M : A \quad \Gamma \vdash N : A}
{\Gamma \vdash M =_A N \type}[=-F]
\]\\
\[
\inference{\Gamma \vdash M : A}
{\Gamma \vdash refl(M) : M =_A M}[=-I]
\]\\
\[
\inference{\Gamma, x, y : A, p : x =_Ay \vdash C \type\\
\Gamma, z : A \vdash c: C[z/x, z/y, refl(z)/p]\\
\Gamma \vdash M : A \quad \Gamma \vdash N : A\\
\Gamma \vdash P : M =_A N}
{\Gamma \vdash R^{Id}_{[x, y, p]}(c, M, N, P) : C[M/x, N/y, P/p]}[=-E$_1$]
\]\\
\end{minipage}
\begin{minipage}{.63\linewidth}
\[
\inference{\Gamma, x, y : A, p : x =_Ay \vdash C \linear\\
\Gamma, z : A; \Xi \vdash c: C[z/x, z/y, refl(z)/p]\\
\Gamma \vdash M : A\\
\Gamma \vdash N : A\\
\Gamma \vdash P : M =_A N}
{\Gamma; \Xi[M/z] \vdash R^{Id}_{[x, y, p]}(c, M, N, P) : C[M/x, N/y, P/p]}[=-E$_2$]
\]\\
\[
\inference{\Gamma \vdash R^{Id}_{[x, y, p]}(c, M, M, refl(M)) : C[M/x, M/y, refl(M)/p]}
{\Gamma \vdash R^{Id}_{[x, y, p]}(c, M, M, refl(M)) \equiv c[M/z]: C[M/x, M/y, refl(M)/p]}
[=-C$_1$]
\]\\
\[
\inference{\Gamma; \Xi \vdash R^{Id}_{[x, y, p]}(c, M, M, refl(M)) : C[M/x, M/y, refl(M)/p]}
{\Gamma; \Xi \vdash R^{Id}_{[x, y, p]}(c, M, M, refl(M)) \equiv c[M/z]: C[M/x, M/y, refl(M)/p]}
[=-C$_2$]
\]\\
\end{minipage}
}
\caption{(Cartesian) identity type}
\label{id}
\end{figure}
\subsection{Linear typing rules}
Perhaps the most important linear types are the $\otimes$- and $I$-types, as they will provide an interpretation of linear contexts. Semantically, we will not distinguish between the context $\Xi :\equiv x_1 : A_1, x_2 : A_2, \dots x_n : A_n$ and $x_1 \otimes x_2 \otimes \dots x_n : A_1 \otimes A_2 \otimes \dots A_n$. 
\begin{figure}[H]
\fbox{
  \begin{minipage}{.5\linewidth}
\[
\inference{\Gamma \vdash A \linear \quad \Gamma \vdash B \linear}{\Gamma \vdash A \otimes B \linear}[$\otimes$-F]
\]\\
\[
\inference{\Gamma; \Xi \vdash a : A \quad \Gamma; \Xi' \vdash b : B}{\Gamma; \Xi, \Xi' \vdash (a, b) : A \otimes B}[$\otimes$-I]
\]\\
\[
\inference{\Gamma; \Xi' \vdash t : A \otimes B \quad \Gamma; \Xi, x : A, y : B \vdash c : C}{\Gamma;\Xi, \Xi' \vdash \text{let $x, y$ be $t$ in $c : C$}}[$\otimes$-E]
\]\\
\[
\inference{\Gamma;\Xi \vdash \text{let $x, y$ be $(a, b)$ in $c : C$}}
{\Gamma; \Xi \vdash \text{let $x, y$ be $(a, b)$ in $c$} \equiv c[a/x][b/y] : C}
[$\otimes$-C]
\]
\end{minipage}
\begin{minipage}{.5\linewidth}
\[
\inference{}{\Gamma \vdash I \linear}[I-F]
\]\\
\[
\inference{}{\Gamma; \cdot \vdash * : I}[I-I]
\]\\
\[
\inference{\Gamma; \Xi \vdash c : C \quad \Gamma; \Xi' \vdash t : I}
{\Gamma; \Xi, \Xi' \vdash \text{ let $t$ be $*$ in c : C}}[I-E]
\]\\
\[
\inference{\Gamma; \Xi \vdash \text{ let $*$ be $*$ in $c : C$}}
{\Gamma; \Xi \vdash \text{ let $*$ be $*$ in $c$} \equiv c : C }[I-C]
\]
\end{minipage}
}
\caption{Linear $\otimes$ and $I$ type formers}
\label{tensor}
\end{figure}
The typing rules for the remaining linear rules are standard.
\begin{figure}[H]
\fbox{
\begin{minipage}{.4\linewidth}
\[
\inference{\Gamma \vdash A \linear \quad \Gamma \vdash B \linear}{\Gamma \vdash A \multimap B \linear}[$\multimap$-F]
\]\\
\[
\inference{\Gamma; \Xi, x : A \vdash b : B}{\Gamma; \Xi \vdash \lambda x. b : A \multimap B}[$\multimap$-I]
\]\\
\[
\inference{\Gamma; \Xi \vdash f : A \multimap B \quad \Gamma; \Xi' \vdash a : A}{\Gamma; \Xi, \Xi' \vdash f(a) : B}[$\multimap$-E]
\]\\
\[
\inference{\Gamma; \Xi \vdash \lambda x. b(a) : B}
{\Gamma; \Xi \vdash \lambda x. b(a) \equiv b[a/x] : B}[$\multimap$-C]
\]
\[
\inference{\Gamma \vdash A \linear \quad \Gamma \vdash B \linear}{\Gamma \vdash A \& B \linear}[\&-F]
\]\\
\[
\inference{\Gamma; \Xi \vdash a : A \quad \Gamma; \Xi \vdash b : B}{\Gamma; \Xi \vdash \langle a, b \rangle : A \& B}[\&-I]
\]\\
\[
\inference{\Gamma; \Xi \vdash t : A \& B}{\Gamma; \Xi \vdash \text{fst}(t) : A}[\&-E$_1$]
\]\\
\[
\inference{\Gamma; \Xi \vdash t : A \& B}{\Gamma; \Xi \vdash \text{snd}(t) : B}[\&-E$_2$]
\]\\
\[
\inference{\Gamma; \Xi \vdash \text{fst}(\langle a, b \rangle): A}
{\Gamma; \Xi \text{fst}(\langle a, b \rangle) \equiv a : A}[\&-C$_1$]
\]\\
\[
\inference{\Gamma; \Xi \vdash \text{snd}(\langle a, b \rangle): B}
{\Gamma; \Xi \vdash \text{snd}(\langle a, b \rangle) \equiv b : B}[\&-C$_2$]
\]
\end{minipage}
\begin{minipage}{.6\linewidth}
\[
\inference{\Gamma \vdash A \linear \quad \Gamma \vdash B \linear}{\Gamma \vdash A \oplus B \linear}[$\oplus$-F]
\]\\
\[
\inference{\Gamma; \Xi \vdash a : A}{\Gamma \Xi \vdash \text{inl}(a): A \oplus B}[$\oplus$-I$_1$]
\]\\
\[
\inference{\Gamma; \Xi \vdash b : B}{\Gamma \Xi \vdash \text{inr}(b): A \oplus B}[$\oplus$-I$_2$]
\]\\
\[
\inference{\Gamma; \Xi, x : A \vdash c : C \quad \Gamma; \Xi, y : B \vdash d : C; \Gamma; \Xi' \vdash t : A \oplus B}
{\Gamma; \Xi, \Xi' \vdash \text{case $t$ of inl$(x) \to c || $inr$(y) \to d : C$}}[$\oplus$-E]
\]\\
\[
  \inference{\Gamma; \Xi \vdash \text{case inl$(a)$ of inl$(x) \to c || $inr$(y) \to d: C$}}{\Gamma; \Xi \vdash \text{case inl$(a)$ of inl$(x) \to c || $inr$(y) \to d \equiv c[a/x] : C$}}[$\oplus$-C$_1$]
\]\\
\[
  \inference{\Gamma; \Xi \vdash \text{case inr$(b)$ of inl$(x) \to c || $inr$(y) \to d: C$}}{\Gamma; \Xi \vdash \text{case inr$(b)$ of inl$(x) \to c || $inr$(y) \to d \equiv d[b/y] : C$}}[$\oplus$-C$_2$]
\]\\
\[
  \inference{}{\Gamma \vdash \top \linear}[$\top$-F]
\]\\
\[
  \inference{\vdash \Gamma; \Xi \text{ctxt}}{\Gamma; \Xi \vdash ! : \top}[$\top$-I]
\]\\
\[
  \inference{}{\Gamma \vdash 0 \linear}[0-F]
\]\\
\[
  \inference{\Gamma; \Xi \vdash t : 0}{\Gamma; \Xi, \Xi' \vdash EFQ(t) : B}[0-E]
\]\\
\end{minipage}
}
\caption{Linear $\multimap$, $\&$, $\oplus$, $\top$ and $0$ type formers}
\label{restoflinear}
\end{figure}


\subsection{Linear-Cartesian interplay}
We introduce two the modal operators $M$ and $L$, which transfers a linear type/term to its cartesian counterpart and vice versa. Semantically, this will establish a fiberwise monoidal adjunction between the categories of linear and cartesian types:
\[
\ti
\mathcal{L}_{\Gamma} \ar[r, "M"{name=A, below}, bend right] & \mathcal{T}_{\Gamma} \ar[l, "L"{name=B, above}, bend right] \ar[from=A, to=B, symbol=\vdash]
\kz
\]
where the exponential modality from traditional linear logic is understood as the comonad $! = LM$. The decomposition of the exponential into an adjunction goes back to at least \cite{bentonmixed}, and is given an interesting new light in \cite{licata2017fibrational}, where it is seen as a particular case of a more general procedure of encoding structure in contexts.

Below are the syntactic rules for the operators $M$ and $L$. \\
\fbox{
\begin{minipage}{.5\linewidth}
\[
\inference{\Gamma \vdash A \type}{\Gamma \vdash A_L \linear}[L-F]
\]\\
\[
\inference{\Gamma \vdash a : A}{\Gamma ; \cdot \vdash a_L : A_L}[L-I]
\]\\
\[
\inference{(\Gamma \vdash B \linear) \\
(\vdash \Gamma; \Xi' \text{ ctxt})\\ \Gamma; \Xi \vdash y : A_L \quad \Gamma, x : A; \Xi' \vdash t : B}{\Gamma; \Xi, \Xi' \vdash \text{let  $x$ be $y$ in }t : B}[L-E]
\]\\
\[
\inference{\Gamma; \Xi \vdash \text{let  $x$ be $s_L$ in }t : B}{\Gamma; \Xi \vdash \text{let  $x$ be $s_L$ in }t \equiv t[s/x]  : B}[L-C]
\]\\
\[
      \inference{\Gamma; y : A_L, \Xi \vdash t : B \\
    \Gamma; y : A_L, \Xi \vdash t' : B \\
      \Gamma, x : A; \Xi \vdash t[x_L/y] \equiv t'[x_L/y] : B\\
      \Gamma; \Xi' \vdash a : A_L }
    {\Gamma; \Xi, \Xi' \vdash t[a/y] \equiv t'[a/y]}[L-U]
  \]\\
\[
  \inference{\Gamma; y : A_L, \Xi \vdash t : B \\
    (\Gamma, x : A; \Xi \vdash t[x_L/y] : B)\\
    \Gamma; \Xi' \vdash a : A_L 
  }
  {\Gamma; \Xi, \Xi' \vdash \text{let $a$ be $x$ in $t[x_L/y]$} \equiv t[a/y] : B}[L-U]
\]

\end{minipage}
\begin{minipage}{.5\linewidth}
\[
\inference{\Gamma \vdash B \linear}{\Gamma \vdash B_M \type}[M-F]
\]\\
\[
\inference{\Gamma ; \cdot \vdash b : B}{\Gamma \vdash b_M : B_M}[M-I]
\]\\
\[
\inference{
\Gamma \vdash t : B_M\\
}{\Gamma; \cdot \vdash \sigma(t) : B \\}[M-E]
\]\\
\[
\inference{
\Gamma \vdash b_M : B_M\\
}{\Gamma; \cdot \vdash \sigma(b_M) \equiv b : B \\}[M-C$_1$]
\]
\[
\inference{
\Gamma \vdash \sigma(t)_M : B_M\\
}{\Gamma \vdash \sigma(t)_M \equiv t : B_M \\}[M-C$_2$]
\]
\end{minipage}
}\\
As a motivation for the semantic interpretation of $L$ and $M$ as adjoint functors given in \ref{semanticML}, we will demonstrate that they already satisfy the relevant conditions from a syntactic point of view. That is, in the spirit of functional programming, we think of the cartesian and linear types (in a context $\Gamma$) of our theory forming the respective categories $\mathcal{T}$ and $\mathcal{L}$ whose morphisms are functions, composition given by function composition. Here, the canonical variable-as-term judgement $\Gamma, x : A \vdash x : A$, or, $\Gamma; z : B \vdash z : B$, yields the identity on a cartesian type $A$ or a linear type $B$, respectively.
\begin{thm}
  $M$ is a (syntactic) functor
  \begin{proof}
$\Gamma; x : A \vdash f : B$, the image of $f$ under $M$ is given by:\\
\[
  \begin{split}
  \Gamma; x : A &\vdash f : B\\
  \Gamma, y : A_M &\vdash y : A_M\\
  \Gamma, y : A_M; \cdot &\vdash \sigma(y) : A\\
  \Gamma, y : A_M; \cdot &\vdash f[\sigma(y)/x] : B\\
  \Gamma, y : A_M &\vdash f[\sigma(y)/x]_M : B_M\\
  \end{split}
\]\\
Similarly, for $\Gamma, x : A \vdash f : B$ (where $\Gamma \vdash B \type$) we get $L(f)$ via:
\[
  \begin{split}
    \Gamma, x : A &\vdash f : B\\
    \Gamma, x : A; \cdot &\vdash f_L : B_L\\
    \Gamma; y : A_L &\vdash y : A_L\\
    \Gamma; y : A_L &\vdash \text{let $x$ be $y$ in $f_L$} : B_L
  \end{split}
\]\\
First, we check that $M(id_A) = id_{MA}$.  The image of the identity morphism $\Gamma; x : A \vdash x : A$ is:
\[
  \Gamma, y : A_M \vdash x[\sigma(y)/x]_M \equiv \sigma(y)_M \equiv y : A_M
\]
Then, given morphisms $\Gamma; x : A \vdash f : B$ and $\Gamma; y : B \vdash g : C$, we see that functoriality of $M$ follows directly from functoriality of substitution. Corresponding to $M(g \circ f)$ we have the term:
\[
\Gamma, z : A_M \vdash g[f/y][\sigma(z)/x]_M : C_M
\],
while $M(g) \circ M(f)$ is given by:
\[
  \begin{split}
    \Gamma, z : A_M &\vdash g[\sigma(f[\sigma(z)/x]_M)/y]_M : C_M \quad \equiv\\
    \Gamma, z : A_M &\vdash g[f[\sigma(z)/x]/y]_M : C_M \quad \equiv\\
    \Gamma, z : A_M &\vdash g[f/y][\sigma(z)/x]_M : C_M
  \end{split}
\]
proving functoriality of $M$.\\
\end{proof}
\end{thm}
Functoriality of $L$ is not as immediate. For this we really need to utilize the uniqueness rule L-U:
\begin{thm}
  $L$ is a (syntactic) functor
  \begin{proof}
The identity on $A$, $\Gamma, x : A \vdash x : A$ is mapped to:
\[
  \Gamma; y : A_L \vdash \text{let $x$ be $y$ in $x_L$} : A_L
\]
Comparing this with the identity:
\[
  \Gamma; y : A_L \vdash y : A_L
\]
and the equality
\[
  \Gamma, x : A; \cdot \vdash \text{let $x$ be $x_L$ in $x_L$} \equiv x_L : A_L
\]
we conclude, using L-U, that $\text{let $x$ be $y$ in $x_L$} = y$.

For types $A, B$ and $C$, and morphisms $\Gamma, x : A \vdash f : B$ and $\Gamma, y : B \vdash g : C$, we want "$L(g \circ f)$":
\[
  \Gamma; z : A_L \vdash \text{let $x$ be $z$ in $g[f/y]_L$} : C_L\\
\]
to equal "$L(g) \circ L(f)$":
\[
  \Gamma; z : A_L \vdash \text{let $y$ be (let $x$ be $z$ in $f_L$) in $g_L$} : C_L
\]\\
This is done in the same fashion. From the equality:
\[
  \Gamma, x : A; \cdot \vdash \text{let $y$ be (let $x$ be $x_L$ in $f_L$) in $g_L$} \equiv \text{let $y$ be $f_L$ in $g_L$} \equiv g_L[f/y] \equiv \text{let $x$ be $x_L$ in $g[f/y]_L$}
\]
and applying L-U we get the desired equality.
\end{proof}
\end{thm}
Furthermore, the categories of cartesian and monoidal types carry a natural monoidal structure, given by $(\times, 1)$ and $(\otimes, I)$, respectively, where $\times$ is simply $\Sigma$ where the second argument does not depend on the first. $M$ and $L$ are monoidal functors with respect to these.\\
\begin{defn}Recall that a functor $F : \mathcal{C} \to \mathcal{D}$ is \textbf{monoidal} if there exists a natural transformation $\mu : F \times F \to F$ with components $\mu_{A,B} : \mathcal{F}(A) \otimes_{\mathcal{D}} \mathcal{F}(B) \to \mathcal{F}(A \otimes_{\mathcal{C}} B)$ and a morphism $I_{\mathcal{D}} \to \mathcal{F}(I_{\mathcal{C}})$. Satisfying the following naturality conditions:\\
\begin{enumerate}%
\item \textbf{(Associativity)} For all objects $x,y,z \in \mathcal{C}$ the following diagram commutes:
  \[
    \ti
    (F(x) \otimes_{\mathcal{D}} F(y)) \otimes_{\mathcal{D}} F(Z)
    \ar[rr,"{a^{\mathcal{D}}_{F(x),F(y),F(z)}}"]
    \ar[d, "{\mu_{x,y} \otimes id}"] & &
    F(x) \otimes_{\mathcal{D}}( F(y)\otimes_{\mathcal{D}} F(z) )
    \ar[d, "{id\otimes \mu_{y,z}}"]\\
    F(x \otimes_{\mathcal{C}} y) \otimes_{\mathcal{D}} F(z)
    \ar[d, "{\mu_{x \otimes_{\mathcal{C}} y , z} }"]
     &&
     F(x) \otimes_{\mathcal{D}} ( F(y \otimes_{\mathcal{C}} z) )
     \ar[d, "\mu_{ x, y \otimes_{\mathcal{C}} z  }"]
     \\
     F( ( x \otimes_{\mathcal{C}} y ) \otimes_{\mathcal{C}} z  )
     \ar[rr, "F(a^{\mathcal{C}}_{x,y,z})"]&&
    F( x \otimes_{\mathcal{C}} ( y \otimes_{\mathcal{C}} z ) )
    \kz
\]
where $a^{\mathcal{C}}$ and $a^{\mathcal{D}}$ denote the associators of the monoidal categories;
\item \textbf{(Unitality)} For all $x \in \mathcal{C}$ the following diagrams commutes:
  \[
    \ti
    1_{\mathcal{D}} \otimes_{\mathcal{D}} F(x)
    \ar[r, "\epsilon \otimes id"]
    \ar[d, "\ell^{\mathcal{D}}_{F(x)}"]
      &
      F(1_{\mathcal{C}}) \otimes_{\mathcal{D}} F(x)
      \ar[d, "\mu_{1_{\mathcal{C}}, x }"]
      \\
      F(x) &
      \ar[l, "F(\ell^{\mathcal{C}}_x)"]
      F( 1 \otimes_{\mathcal{C}} x)
      \kz
\]
and
  \[
    \ti
     F(x) \otimes_{\mathcal{D}} 1_{\mathcal{D}} 
    \ar[r, "id \otimes \epsilon"]
    \ar[d, "r^{\mathcal{D}}_{F(x)}"]
      &
      F(x) \otimes_{\mathcal{D}}F(1_{\mathcal{C}}) 
      \ar[d, "\mu_{x, 1_{\mathcal{C}}}"]
      \\
      F(x) &
      \ar[l, "F(r^{\mathcal{C}}_x)"]
      F( x \otimes_{\mathcal{C}} 1)
      \kz
\]
where $\ell^{\mathcal{C}}$, $\ell^{\mathcal{D}}$, $r^{\mathcal{C}}$, $r^{\mathcal{D}}$ denote the left and right unitors of the two monoidal categories, respectively.
\end{enumerate}

As our current syntactic endeavors mainly serve as motivation for the semantic interpretation of these operators, given in \ref{semanticML}, we will not prove the complete statement here. We omit the naturality conditions and only prove the following:
\end{defn}
\begin{thm}
There are terms $t_1, t_2, t_3, t_4$, relating the operators $M$ and $L$ so that the judgements:
  \[
    \begin{split}
      \Gamma, x : 1 &\vdash t_2 : I_M\\
      \Gamma, x : A_M \times B_M &\vdash t_1 : (A \otimes B)_M\\
      \Gamma; x : I &\vdash t_4 : 1_L\\
      \Gamma; x : A_L \otimes B_L &\vdash t_3 : (A \times B)_L
    \end{split}
  \]
  hold.
  \begin{proof}
    $t_1$ is given by the following expression:
    \[
      \Gamma, x : 1 \vdash *_M : I_M\\
    \]
    and $t_2$ can easily be derived:
    \[
      \Gamma, x : A_M \times B_M \vdash \sigma(pr_1(x)) \otimes \sigma(pr_2(x)) : (A \otimes B)_M
    \]
$t_3$ is given by:
    \[
      \Gamma; x : I \vdash \text{let $x$ be $*$ in $\star_L$} : 1_L
    \]
$t_4$ is a bit more involved, as it requires two applications of L-E. For clarity, we display the complete proof tree of the term:
\begin{prooftree}
  \AxiomC{$\Gamma, x : A, y : B \vdash x : A$}\noLine
  \UnaryInfC{$\Gamma, x : A, y : B \vdash y : B$}
  \UnaryInfC{$\Gamma, x : A, y : B \vdash (x, y) : A \times B$}
  \UnaryInfC{$\Gamma, x : A, y : B; \cdot \vdash (x, y)_L : (A \times B)_L$}
  \AxiomC{}
  \UnaryInfC{$\Gamma, x : A; y' : B_L \vdash y' : B_L$}
  \BinaryInfC{$\Gamma, x : A; y' : B_L \vdash \text{let $y$ be $y'$ in $(x, y)_L$}: (A \times B)_L$}
  \AxiomC{}
\UnaryInfC{$\Gamma; x' : A_L \vdash x' : A_L$}\LeftLabel{L-E}
\BinaryInfC{$\Gamma; x' : A_L, y' : B_L \vdash \text{let $x$ be $x'$ in (let $y$ be $y'$ in $(x, y)_L$)}: (A \times B)_L$}
\AxiomC{}
\UnaryInfC{$\Gamma; z : A_L \otimes B_L \vdash z : A_L \otimes B_L$}\LeftLabel{$\otimes$-E}
\BinaryInfC{$\Gamma; z : A_L \otimes B_L \vdash \text{let $(x', y')$ be $z$ in (let $x$ be $x'$ in (let $y$ be $y'$ in $(x, y)_L$))} : (A \times B)_L$}
\end{prooftree}

\end{proof}
\end{thm}
Finally, we show that $M$ and $L$ can be thought of as adjoint functors, in any context. In other words, we will show that there exists a ``natural transformation'' $\epsilon : LM \to 1$ satisying the following universal property:\\
For any $f : L(A) \to B$, there is a unique morphism $g : A \to B_M$, such that $\epsilon_B \circ L(g) = f$.\\
Translated into the syntax of our type theory, the statement becomes the following:\\
\begin{thm}[$L \dashv M$]
There is a term $\Gamma; \beta_1 : B_{LM} \vdash \epsilon_B: B$ with the following property:\\
For any term: $\Gamma; y : A_L \vdash f : B$, there is a unique term $\Gamma, x : A \vdash g : B_{M}$ such that $\Gamma; y : A_L \vdash \epsilon_B[\text{let $x$ be $y$ in }g_L/\beta_1] \equiv f : B$.\\
\begin{proof}
 The counit $\epsilon : LM \to 1_{\mathcal{L}_{\Gamma}}$ is at any component $B$ given by:
 \[
  \begin{split}
    \Gamma, \beta_1 : B_{M} &\vdash \beta_1 : B_{M}\\
    \Gamma, \beta_2 : B_{M} &\vdash \beta_2 : B_{M}\\
    \Gamma, \beta_2 : B_{M}; &\cdot \vdash \sigma(\beta_2) : B\\
    \Gamma; \beta_1 : B_{LM} &\vdash \text{let $\beta_2$ be $\beta_1$ in }\sigma(\beta_2) : B 
  \end{split}
\]
  where the last line is given by applying L-E to the first and third line.\\
  For any $\Gamma; x : A_L \vdash f : B$, we get the corresponding $g$ through:
  \[
    \begin{split}
      \Gamma, x : A &\vdash x : A\\
      \Gamma, x : A; \cdot &\vdash x_L : A\\
      \Gamma, x : A; \cdot &\vdash f[x_L/y] : B\\
      \Gamma, x : A &\vdash f[x_L/y]_M : B_M
      \end{split}
    \]
    making $Lg$ the term:
\[
  \begin{split}
    \Gamma; y : A_L &\vdash \text{let $x$ be $y$ in } f[x_L/y]_{LM} : B_{LM}
  \end{split}
\]
our composite $\epsilon_B \circ Lg$ is given by substituting the above for $\beta_1$ in the term correpsonding to $\epsilon_B$, yielding:
\[
  \Gamma; y : A_L \vdash \text{let $\beta_2$ be (let $x$ be $y$ in $f[x_L/y]_{LM}$) in }\sigma(\beta_2) : B
\]
Finally, if we substitute $x_L$ for $y$ in the above, we can rewrite the expression using L-C to:
\[
  \begin{split}
    \Gamma, x : A; \cdot &\vdash \text{let $\beta_2$ be $f_{LM}$ in }\sigma(\beta_2) : B \equiv \\
    \Gamma, x : A; \cdot &\vdash \sigma(\beta_2)[f_M / \beta_2] \equiv f : B
  \end{split}
\]
so by L-U, we can transform this equality to the desired
\[
\Gamma; y : A_L \vdash \text{let $\beta_2$ be (let $x$ be $y$ in $f[x_L/y]_{LM}$) in }\sigma(\beta_2) \equiv f : B
\]
  It remains to show that for any other term $\Gamma; x : A \vdash h : B_M$ such that $\epsilon_B \circ Lh = f$, we have $g = h$. Syntactically, $\epsilon_B \circ Lh = f$  corresponds to the judgement:
  \[
    \Gamma; y : A_L \vdash \text{let $\beta_2$ be $(\text{let $x$ be $y$ in $h_L$})$ in }\sigma(\beta_2) \equiv f : B
  \]
  If we weaken the cartesian context by $x : A$, we can substitute $x_L$ for $y$ and get:
  \[
    \begin{split}
      \Gamma, x : A; \cdot \vdash \text{let $\beta_2$ be $(\text{let $x$ be $x_L$ in $h_L$})$ in }\sigma(\beta_2) \equiv \sigma(h) \equiv f[x_L/y] : B
    \end{split}
    \]
    finally, we apply $M$ and get:
    \[
      \Gamma, x : A \vdash \sigma(h)_M \equiv h \equiv f[x_L/y]_M : B
    \]
\end{proof}
\end{thm}
\subsubsection{Linear dependent types}
Since we allow linear types to dependend on terms of cartesian types, we can form new versions of the $\Pi$- and $\Sigma$-types. We will denote these linear variants of $\Pi$- and $\Sigma$-types by $\sqcap$ and $\sqsubset$, respectively.\\
\fbox{
\begin{minipage}{.5\linewidth}
\[
\inference{\Gamma \vdash A \type \quad \Gamma, x : A \vdash B \linear}{\Gamma \vdash \sqcap_{x : A}B \linear}[$\sqcap$-F]
\]\\
\[
  \inference{\vdash \Gamma; \Xi \text{ ctxt}\\
    \Gamma, x : A; \Xi \vdash b : B
  }
{\Gamma; \Xi \vdash \lambda x. b : \sqcap_{x: A}B}[$\sqcap$-I]
\]\\
\[
\inference{\Gamma; \Xi \vdash t : \sqcap_{x : A}B \quad \Gamma \vdash a : A}
{\Gamma; \Xi \vdash t(a) : B[a/x]}[$\sqcap$-E]
\]\\
\[
\inference{\Gamma; \Xi \vdash \lambda x. b (a) : \sqcap_{x : A}B}
{\Gamma; \Xi \vdash \lambda x. b (a) \equiv b[a/x] : B[a/x]}[$\sqcap$-C]
\]
\end{minipage}
\begin{minipage}{.5\linewidth}
\[
\inference{\Gamma \vdash A \type \quad \Gamma, x : A \vdash B \linear}{\Gamma \vdash \sqsubset_{x : A}B \linear}[$\sqsubset$-F]
\]\\
\[
\inference{\Gamma \vdash s : A \quad \Gamma; \Xi \vdash b : B[s/x]}{\Gamma; \Xi \vdash (s, b) : \sqsubset_{x : A}B}[$\sqsubset$-I]
\]\\
\[
  \inference{\vdash \Gamma;\Xi' \text{ ctxt}\\
    \Gamma \vdash C \linear\\
    \Gamma; \Xi \vdash t : \sqsubset_{x : A}B \quad \Gamma, x : A; \Xi', y : B \vdash c : C}{\Gamma; \Xi, \Xi' \vdash \text{let $x, y$ be $t$ in c : C}}[$\sqsubset$-E]
\]\\
\[
\inference{\Gamma; \Xi \vdash \text{let $x, y$ be $(s, t)$ in c : C}}
{\Gamma; \Xi \vdash \text{let $x, y$ be $(s, t)$ in c} \equiv c[s/x][t/y] : C}[$\sqsubset$-C]
\]
\end{minipage}
}\\
An example of a $\sqcap$ type, consider for any linear type $A$, the n-fold tensor product $A^n :\equiv A \otimes A \dots A$, which we can define by induction over the natural numbers (using universes) via:
\[
  \begin{split}
  A^0 &:\equiv I\\
  A^{\text{suc }(n)} &:\equiv A \otimes A^n
  \end{split}
\]
with this construct, recall the example of burning hydrogen given in \ref{burn}, now expressed as a linear function $burn : O_2 \otimes H_2 \otimes H_2 \multimap H_2O \otimes H_2O$. With a dependent, linear function type, we can generalize this process to the function:
\[
  \begin{split}
  burn : \sqcap_{n : \mathbb{N}}O_2^n \otimes H_2^{2n} \multimap H_2O^{2n}
  \end{split}
\]
\\
An example of the $\sqsubset$ type comes from Krishnaswami's treatment of linear dependent logic as a way to model imperative programs \cite{krishnaswami}. Here, a primitive type of memory locations, $\Gamma \vdash Loc \type$, is introduced, the terms $x$ of which can reference a term of any cartesian type $A$ by means of a term of the linear pointer type $[x \mapsto A]$:
\[ 
  \inference{\Gamma \vdash A \type}
  {\Gamma, x : Loc \vdash [x \mapsto A] \linear}
\]
Given a location $a : Loc$ and a term $t : A$ in a context $\Gamma$, one may allocate some memory at $a$, and create a pointer $a \mapsto t$ at a certain fixed cost, $\Xi$:
\[
  \inference{\Gamma \vdash t : A \quad \Gamma \vdash a : Loc}
  {\Gamma; \Xi \vdash a \mapsto t : [a \mapsto A]}
\]
But if we want to reason more generally about our pointers, we might be interested in a more general pointer type, where the location variable is bound in a $\sqsubset$-type. This type is formed in any context $\Gamma$, for any type $A$:
\[
  \inference{\Gamma \vdash A \type \quad \Gamma, x : Loc \vdash [x \mapsto A] \linear} 
  {\Gamma \vdash \sqsubset_{x : A}[x \mapsto A] \linear}
\]
with terms introduced by:
\[
  \inference{\Gamma \vdash t : A \quad \Gamma \vdash a : Loc \quad \Gamma; \Xi \vdash t : [a \mapsto A]}
  {\Gamma; \Xi \vdash (a, t) : \sqsubset_{x : Loc} [x \mapsto A]}
\]


Another example takes inspiration from the realm of blockchain technology, where one deals with resources like bitcoin or ether balances. Say we model ownership of ether by a public address (generated from a cryptographic public key) having the linear type $addr_1 : ETH$. Then we can model a decentralized  mathematical prize comittee, which give out a reward of 1 ether to whoever proves the Goldbach conjecture.\\
Since the reward is constant, this is not truly a dependent linear function and we abusively notate it by $\multimap$:
\[
\cdot; x : ETH \vdash GoldbachReward: \Pi_{x : \mathbb{N}}\Sigma_{y, z : \mathbb{N}}Prime(y) \times Prime(z) \times y + z =_{\mathbb{B}} 2(suc(suc(x))) \multimap ETH
\]
To execute the transaction, one would need to exhibit that there is an address $x$ with one ether to begin with and provide a proof of the Goldbach conjecture.\\
\subsection{Universes}
Our cartesian and linear types live in separate universes, $U$ and $L$. Since linear types are type checked in a purely cartesian context, the linear universe is a cartesian type. Our universes are given á la Tarski and are closed under all previously introduced type formers. Below, we only outline the closure over the type formers $\Pi$, $\otimes$ and $\sqcap$, but this should be sufficient to give the idea. For more detail we refer to Hofmann's \textit{Syntax and Semantics of Dependent types}, \cite{hofmann1997syntax}, or Krishnaswami's \textit{Integrating Linear and Dependent types}, \cite{krishnaswami}.\\
\fbox{
  \begin{minipage}{.5\linewidth}
    \[
      \inference{\vdash \Gamma \text{ ctxt}}{\Gamma \vdash U \type}[$\mathcal{U}$-F]
    \]\\
    \[
      \inference{\Gamma \vdash t : U}{\Gamma \vdash El(t) \type}[U-El-F]
    \]\\
    \[
      \inference{\Gamma \vdash t : U \\
        \Gamma, x : El(t) \vdash v : U}
        {\Gamma \vdash \hat \Pi_{x : El(t)}v : U}[U-$\Pi$]
      \]\\
      \[
        \inference{\Gamma \vdash t : U \\
        \Gamma, x : El(t) \vdash v : U}
        {\Gamma \vdash  El(\hat \Pi_{x : El(t)}v) \equiv \Pi_{x : El(t)}El(v)}[U-$\Pi$-Ty]
      \]
\end{minipage}
\begin{minipage}{.5\linewidth}
        \[
      \inference{\vdash \Gamma \text{ ctxt}}{\Gamma \vdash L \type}[L-F]
    \]\\
    \[
      \inference{\Gamma \vdash t : L}{\Gamma \vdash El(t) \linear}[L-El-F]
    \]\\
    \[
      \inference{\Gamma \vdash t : L \quad \Gamma \vdash s : L}{\Gamma \vdash t \hat \otimes s : L}[L-$\otimes$]
    \]\\
        \[
          \inference{\Gamma \vdash t : L \\
            \Gamma \vdash s : L}{El(t \hat \otimes s) \equiv El(s) \otimes El(t)}[L-$\otimes$-Ty]
    \]\\
    \[
      \inference{\Gamma \vdash t : U\\
        \Gamma, x : El(t) \vdash s : L}
        {\Gamma \vdash \hat \sqcap_{x : El(t)} s : L}[L-$\sqcap$]
    \]\\
    \[
      \inference{\Gamma \vdash t : U\\
        \Gamma, x : El(t) \vdash s : L}
        {\Gamma \vdash El(\hat \sqcap_{x : El(t)} s) \equiv \sqcap_{x : El(t)}El(s)} [L-$\sqcap$-Ty]
    \]\\
  \end{minipage}
}\\
\section{Semantics}
\subsection{Structural semantic core}
To explore the models of linear dependent type theory we begin by constructing a categorical structure which abstracts the key features of the theory. We will utilize the notion of a \textit{comprehension category}, which provides the most general structure in which we can deal with the structural rules like context extensions and substitutions. Once this has been taken care of we may consider what extra conditions have to be imposed in order for the model to support various type constructors, and then provide concrete models that satisfy these conditions.\\

There are only two type constructors that will be assumed in the general semantic structure: the linear tensor product and unit. This simplifies the core semantics by allowing us to use symmetric monoidal categories instead of multicategories when interpreting linear types.

The idea behind the core of the semantics is to construct a comprehension category \cite{jacobs}, consisting of a base category of contexts, a 'cartesian' fibration consisting of cartesian types equipped with context extensions, and a lax symmetric monoidal fibration consisting of linear types.
\begin{defn}
A \textbf{comprehension category} consists of a commutative diagram of functors
\[
\ti
\mathcal{T} \ar[rd, "p"] \ar[r, "\pi"]  & \mathcal{C}^{\to} \ar[d, "\text{cod}"]\\
& \mathcal{C}
\kz
\]
where $B^\to$ is the arrow category of $B$ and $cod : B^\to \to B$ denotes the codomainfunctor such that:
\begin{enumerate}%
\item $\mathcal{C}$ has a terminal object
\item $p : \mathcal{T} \to \mathcal{C}$ is a Grothendieck fibration,
\item $\pi : \mathcal{T} \to \mathcal{C}^\to$ takes cartesian morphisms in $\mathcal{T}$ to cartesian morphisms in $\mathcal{C}^\to$
\end{enumerate}
Notice that by the second condition, cartesian morphisms in $\mathcal{T}$ are mapped to pullback squares in $\mathcal{C}$:\\
A cartesian morphism $(p, q) : f \to g$ in $\mathcal{C}^\to$ is a commutative square in $\mathcal{C}$
\[
\ti
B \ar[r, "g"] \ar[d, "p"] & B' \ar[d, "q"]\\
A \ar[r,"f"] & A'
\kz
\]
such that for any $E'$, $E$, $q' : E' \to B'$, $e : E \to E'$ and $p' : E \to A$ as in the following diagram:
\[
\ti
E \ar[d, "id_E"] \ar[r, "e"] & E' \ar[d, "q'"] \\
E \ar[d, "p'"] \ar[r, "q'e"] & B' \ar[d,"q"] \\
A \ar[r, "f"] & A'
\kz
\]
there is a unique arrow $u : E \to B$ such that $p' = p \circ u$ and $q'e = g \circ u$. This is precisely the universal property of the pullback.
If $\mathcal{C}$ has all pullbacks, then $\text{cod} : \mathcal{C}^\to \to \mathcal{C}$ is a fibration and we immediately have a comprehension category.
Maps of $\mathcal{C}$ that arise via $\pi(A)$ for some $A \in \mathcal{T}$ will be called \textit{projections}, and by the remark above, pullbacks of projections always exist. Terms of a type will be interpreted as sections of the corresponding projections and pullbacks of $\mathcal{C}$ will play the role of substitutions. Here we need to be careful, however:
\end{defn}
\begin{remrk}On Coherence. A sublety often overlooked in the construction of models of type theory are the various issues arising from the fact that from a categorical point of view, it is natural to consider objects up to isomorphism, whereas in type theory we speak of equality ``on the nose'' \cite{lccc}. In particular, when interpreting substitution as a pullback, we need to take into account that, in the syntax, substitution is strictly runctorial, while pullbacks, in general, are not. For example, the pullback of $f$ along $g \circ h$ is \textit{isomorphic to} the pullback of $\pi_1$ along $h$, below, but not necessarily equal to it.
  \[
    \ti
    A \times_C B' \cong (A \times_C B) \times_C B'  \ar[r] \ar[d] & B' \ar[d, "h"]\\
    A \times_C B \ar[r, "\pi_1"] \ar[d, "\pi_2"] & B \ar[d, "g"]\\
    A \ar[r,"f"] & C
    \kz
  \]
  This problem can generally be overcome by showing that there exists a suitable choice of pullbacks such that this isomorphism is an equality, and this is essentially why we are forcing our comprehension category to come equipped with liftings of every map in the base category, so that our fibration is \textit{split}. In fact, every comprehension category is equivalent to a strict one, and if a full comprehension category supports various type formers, then these will also be supported in the corresponding split version. \cite{pllcoherence}\\
  In dealing with linear dependent type theory, we run into a similar problem. Equipped with a (lax) monoidal fibration, $q : \mathcal{L} \to \mathcal{C}$, we will interpret linear contexts $\Xi = a_1 : A_1, a_2 : A_2 \dots a_n : A_n$ over a cartesian context $\Gamma$ as the tensor product $[[\Xi]] = [[A_1]] \otimes [[A_2]] \dots \otimes [[A_n]]$ in the monoidal category $\mathcal{L}_\Gamma$. The weakening of a linear context $\Xi$, as given by the rule:
  \[\inference{\vdash \Gamma; \Xi \text{ ctxt} \quad \Gamma \vdash A \type}{\vdash \Gamma, x : A; \Xi \text{ ctxt}}[C-Weak]
  \]
  will be interpreted as the image of the object $[[\Xi]] \in \mathcal{L}_\Gamma$ under the functor $\pi_A^* : \mathcal{L}_\Gamma \to \mathcal{L}_{\Gamma.A}$ induced by the projection morphism $\pi_A : \Gamma.A \to \Gamma$ in the base. But in general, we do not have an equality of $\pi_A^*(A) \otimes \pi_A^*(B)$ and $\pi_A^*(A \otimes B)$. To accomodate this discrepancy, we introduce the notion of a split monoidal fibration:
\end{remrk}
\begin{defn}
 A \textbf{split monoidal fibration} is a lax monoidal fibration $q : \mathcal{L} \to \mathcal{C}$, equipped with a cleavage  $\{ u^*, \bar u \}_{u \in \mathcal{C}}$, so that every lift $u^*$ is a strict monoidal functor, and $u^*v^* = (vu)^*$ for all compatible liftings $u^*$ and $v^*$.
\end{defn}
Notice that this condition is quite strong, as the induced functors of a lax monoidal fibration are generally only lax monoidal. However, every lax monoidal fibration where the induced functors are strong will be equivalent to a split monoidal fibration. Equipped with these notions, we define the general structure of the structural core of our type theory:

A model for linear dependent type theory consists of a split comprehension category $p : \mathcal{T} \to \mathcal{C}$ and a split monoidal fibration $q : \mathcal{L} \to \mathcal{C}$, as illustrated in the following picture:
\[
\ti
\mathcal{L} \ar[rd, "q"] & \mathcal{T} \ar[d, "p"] \ar[r, "\pi"] & \mathcal{C^\rightarrow} \ar[ld, "\text{cod}"]\\
& \mathcal{C}
\kz
\]
Before showing how this works in detail, the following lemma will come in handy:
\begin{lemm}\label{pb-lem}
  The pullback of an arrow, $g$, has a section if $g$ does. In other words, given a pullback of $g$:
  \[
    \ti
    A \times_{C} B \ar[d, "g^*"] \ar[r, "k"] & B \ar[d, "g", bend right]\\
    A \ar[r, "f"] & C \ar[u, "h", bend right]
    \kz
  \]
  such that $gh = 1_C$, then $h^*$ exists and is a section of $g^*$.
\begin{proof}
Since $A$ with projections $1_A$ and $hf$ forms a cone to the cospan, there exists a unique map $u : A \to A \times_{C} B$ such that $hfu = k$ and $g^*u = 1_A$, making $u$ a section of $g^*$.
\end{proof}
\end{lemm}
We prove soundness by defining an interpretation function by induction on the derivation rules of Figure \ref{struc}.
\begin{thm}[Soundness]
A split comprehension category $p : \mathcal{T} \to \mathcal{C}$ together with a split monoidal fibration $q : \mathcal{L} \to \mathcal{C}$ is a model for the linear dependent type theory consisting of the structural rules presented in Figure \ref{struc}.
\begin{proof}
  We construct an interpretation function $[[-]]$, which sends:
  \begin{itemize}
  \item Cartesian contexts $\Gamma$ to objects of $\mathcal{C}$, considered up to definitional equality and renaming of bound variables.
  \item Linear contexts $\Xi$ in $\Gamma$ to objects of $\mathcal{L}_{[[\Gamma]]}$.
  \item Cartesian types $A$ in $\Gamma$ to objects of $\mathcal{T}_{[[\Gamma]]}$.
  \item Linear types $B$ in $\Gamma$ to objects of $\mathcal{L}_{[[\Gamma]]}$.
  \item Cartesian terms $M : A$ in $\Gamma$ to sections of $\pi([[A]]) : [[\Gamma,A]] \to [[\Gamma]]$.
  \item Linear terms $b : B$ in $\Gamma; \Xi$ to morphisms $[[b]] : [[\Xi]] \to [[B]]$.
  \end{itemize}
Proceeding by induction on the derivation rules, we will often abuse notation slightly and denote semantic objects the same as their syntatic counterparts.
\begin{itemize}
\item Case of CI-Base: $[[\cdot]]$ is the terminal object $\mathbf{1}$ of $\mathcal{C}$.
\item Case of CM-Base: $[[\cdot; \cdot]]$ is the unit of $\mathcal{L}_{\mathbf{1}}$.
\item Case of C-int-ext: By the induction hypothesis, we are given $A$ in $\mathcal{T}_{\Gamma}$ and need to display an object $\Gamma.A$ in $\mathcal{C}$. This object is the domain of the morphism that $A$ is mapped to via $\pi$:
  \[\Gamma.A \xrightarrow {\pi_A} \Gamma\]
\item Case of C-lin-ext: Given objects $[[\Xi]]$ and $[[A]]$ in $\mathcal{L}_{[[\Gamma]]}$, the extended context $\Gamma; \Xi, x : A$ is interpreted as the object $[[\Xi]] \otimes [[A]] \in \mathcal{L}_{[[\Gamma]]}$.
\item Case of C-weak-1: Given $A, \Delta \in \mathcal{T}_{\Gamma}$, we send $\Delta$ through the functor $\pi_A^* : \mathcal{T}_\Gamma \to \mathcal{T}_{\Gamma.A}$ induced by lifting the morphism $\pi_A : \Gamma.A \to \Gamma$. The resulting object $\pi_A^*(\Delta)$ will be sent to the context $p(\pi_A^*(\Delta)) = \Gamma.A.\Delta\{\pi_*\}$ via $p$, which is the interpretation of the conclusion of the rule C-weak-1.
\item Case of C-weak-2: Notice that since $\pi$ is a cartesian functor, the context above fits into the following pullback:
\[
\ti
\Gamma.A.\Delta\{\pi_A\} \ar[r, "q"] \ar[d, "\pi_{\Delta\{\pi_A\}}"]  & \Gamma.\Delta \ar[d, "\pi_\Delta"]\\
\Gamma.A \ar[r, "\pi_A"] & \Gamma
\kz
\]
so by lifting $q$ to the monoidal functor $q^* : \mathcal{L}_{\Gamma.\Delta} \to \mathcal{L}_{\Gamma.A.\pi^*(\Delta)}$. The context we are looking for is the image of $\Xi$ under this functor.
\item Case of C-lin-ext: For objects $\Xi$ and $A$ in $\mathcal{L}_{\Gamma}$, we let their tensor product $\Xi \otimes A$ denote the extended context $\Gamma; \Xi, x : A$.
%\item Case of Int-exch: For $A$ and $B$ in $\mathcal{T}_{\Gamma}$, $\Gamma.A.B\{\pi_A\}$ and $\Gamma.B.A\{\pi_B\}$ are both pullbacks of the cospan:
%\[
%\ti
%& \Gamma.B \ar[d, "\pi_B"]\\
%\Gamma.A \ar[r, "\pi_A"] & \Gamma
%\kz
%\]
%since the cartesian lifts of these arrows are sent to pullback squares in $\mathcal{C}^\to$. Hence they are isomorphic, and so any object $\Gamma'$ in $\mathcal{T}_{\Gamma.A.B\{\pi_A\}}$ may equally well be thought of as an object in $\mathcal{T}_{\Gamma.B.A\{\pi_B\}}$.
\item Case of Lin-exch. Since our lax monoidal fibration is symmetric, we have $\Xi \otimes A \otimes B \otimes \Xi' \cong \Xi \otimes B \otimes A \otimes \Xi'$ in $\mathcal{L}_{\Gamma}$. Applying exchange to a judgement corresponds to composing with this isomorphism.
\item Case of Weak-L. For any $A \in \mathcal{T}_{\Gamma}$ and morphism $t : \Xi \to A$ in $\mathcal{L}_{\Gamma, \Gamma'}$, we can transfer $t$ along the functor $q_{A, \Gamma}^* : \mathcal{L}_{\Gamma, \Gamma'} \to \mathcal{L}_{\Gamma.A.\Gamma'\{\pi_A\}}$ induced by the map $q_{A, \Gamma'}$ arising from the following pullback diagram:
\[
\ti
\Gamma.A.\Gamma'\{\pi_A\} \ar[r] \ar[d, "q_{A, \Gamma'}"]  & \Gamma.\Gamma' \ar[d, "\pi_\Gamma'"]\\
\Gamma.A \ar[r, "\pi_A"] & \Gamma
\kz
\]
to yield a morphism $q_{A, \Gamma'}^*(t) : q_{A, \Gamma'}^*(\Xi) \to q_{A, \Gamma'}^*(A')$.
\item Case of Weak-I. The morphism $q_{A, \Gamma'}$ above also induces a functor $q_{A, \Gamma'}^* : \mathcal{T}_{\Gamma, \Gamma'} \to \mathcal{T}_{\Gamma.A.\Gamma'.\{\pi_A\}}$.
\item For Int-subst-1, the judgement $\mathcal{J}$ can take three forms:
\[
\mathcal{J} = B[M/x] \text{ type}
\]
\[
\mathcal{J} = b[M/x] : B[M/x]
\]
\[
\mathcal{J} = B[M/x] \text{ linear}
\]
The corresponding categorical structure work by way of relating substitution in the theory to pullbacks in $\mathcal{C}$. We begin with showing that there is a type $B[M/x]$ in the context $\Gamma. \Gamma'[M/x]$.\\
Suppose we are given the following objects of $\mathcal{T}$:
\[
\begin{split}
&A \in \mathcal{T}_{\Gamma}\\
&\Gamma' \in \mathcal{T}_{\Gamma.A}\\
&B \in \mathcal{T}_{\Gamma.A.\Gamma'}\\
\end{split}
\]
and a section:
\[
\begin{split}
&M : \Gamma \to \Gamma.A\\
\end{split}
\]
of the projection $\pi_A$. We first lift $M$ to a cartesian arrow $M^* : \Gamma.\Gamma'\{M\} \to \Gamma'$, which is sent to the following pullback square by $\pi$:
\[
\ti
\Gamma.\Gamma'\{M\} \ar[d, "\pi_{\Gamma'\{M^*\}}"] \ar[r, "q_{(M, \Gamma')}"] & \Gamma.A.\Gamma' \ar[d, "\pi_{\Gamma'}"]\\
\Gamma \ar[r,"M"] & \Gamma.A
\kz
\]
where ${q_{(M, \Gamma')}}$ is some map whose existance is given by the structure of the comprehension. We then lift $q_{(M, \Gamma')}$ to obtain a cartesian arrow $q_{(M, \Gamma')}^* : \Gamma.\Gamma'\{M^*\}.B\{q_{(M, \Gamma')}^*\} \to \Gamma.A.\Gamma'.B$ which fits in the following pullback diagram:
\[
\ti
\Gamma.\Gamma'\{M^*\}.B\{q_{(M, \Gamma')}^*\} \ar[d, "\pi_{B\{q_{(M, \Gamma')}^*\}}"] \ar[r,"q_{(q_{(M, \Gamma')},B)}"] & \Gamma.A.\Gamma'.B \ar[d, "\pi_B"] \\
\Gamma. \Gamma'\{M^*\} \ar[r, "q_{(M, \Gamma')}"]  & \Gamma.A.\Gamma'
\kz
\]
The element $\Gamma.\Gamma'\{M^*\}.B\{q^*_{M,\Gamma'}\}$ of $\mathcal{T}_{\Gamma.\Gamma'\{M^*\}}$ along with its associated projection will be our interpretation of $\Gamma.\Gamma'[M/x] \vdash B[M/x]$.\\
Now suppose there is a section $b : \Gamma.A.\Gamma' \to \Gamma.A.\Gamma'.B$ of the projection $\pi_B$. To display an element of $B[M/x]$ is to give a section of $\pi_{B\{q^*_{(M,\Gamma')}\}}$. By lemma \ref{pb-lem}, we get such a section by pulling back $b$ along $q_{(q_{(M, \Gamma')},B)}$.
\\
Finally, if $B$ is an object of $\mathcal{L}_{\Gamma.A.\Gamma'}$, then the image of $B$ under the functor $q_{(M, \Gamma')}^* : \mathcal{L}_{\Gamma.A.\Gamma'} \to \mathcal{L}_{\Gamma.\Gamma'\{M^*\}}$ will be our interpretation of $B[M/x]$ as a linear type in the context $\Gamma,\Gamma[M/x]$.
\item Case of Int-subst-2. The interpretation of Int-subst-2 is the image of $t$ under $q_{(M, \Gamma')}^*$.
\item Case of Lin-subst. Given morphisms $t : \Xi \otimes A \to B$ and $M : \Xi' \to A$ we get a morphism $t \circ (id_\Xi \otimes M) : \Xi \otimes \Xi' \to B$. Precomposing with the isomorphism $\bigotimes \Xi, \Xi' \cong \Xi \otimes \Xi'$ yields the desired morphism $\bigotimes \Xi, \Xi' \to B$.
\item Case of Int-var. For any $A \in \mathcal{T}_\Gamma$, the pullback:
  \[
    \ti
    \Gamma.A.A\{\pi_A\} \ar[r, "q"] \ar[d, "\pi_{A_{\{\pi_A\}}}"] & \Gamma.A \ar[d, "\pi_A"]\\
    \Gamma.A \ar[r, "\pi_A"] & \Gamma
    \kz
  \]
  is in fact (isomorphic to) the product $\Gamma.A \times \Gamma.A$, and so the diagonal map $\Delta : \Gamma.A \to \Gamma.A \times \Gamma.A$ forms a section to both projections.
  This map is thus the interpretation of the judgement $\Gamma, x : A \vdash x : A$.
\item Case of Lin-var. The morphism corresponding to the linear variable term $\Gamma; x : A \vdash x : A$ is given by the identity morphism on $A$ in $\mathcal{L}_{\Gamma}$.
\end{itemize}
\end{proof}
\end{thm}
\subsection{Semantic type formers}
In the following, we assume that the comprehension category comprising the core of our syntax is full. \begin{defn}A \textbf{model of LDTT} is a full, split comprehension category $\pi : \mathcal{T} \to \mathcal{C}^{\to}$ and a split monoidal fibration $q : \mathcal{L} \to \mathcal{C}$. In some cases we also assume that the comprehension category has a unit, i.e. that there is a functor $\mathbf{1} : \mathcal{C} \to \mathcal{T}$, assigning a terminal object to every fiber which is a left adjoint to the functor $s(\pi) : \mathcal{T} \to \mathcal{C}$, selecting the source of the morphism assigned by $\pi$. This yields the nice property that $\mathcal{C}_{/\Gamma}(\Gamma.A, \Gamma.B) \cong \mathcal{T}_{\Gamma.A}(1, \pi_A^*(B))$, allowing us to shift in perspective to think of terms depending on $\Gamma$ and $A$ as either living in the slice category $\mathcal{C}_{/\Gamma}$ or in the fiber $\mathcal{T}_{\Gamma.A}$.
\end{defn}
\begin{defn}
  A model of LDTT \textbf{supports $I$-types} if, for every $\Gamma$, there is exists an object $[[I]] \in \mathcal{L}_{\Gamma}$, equipped with a morphism $[[*]] : I \to [[I]]$, such that for every pair of maps $t : \Xi' \to [[I]]$ and $c : \Xi \to C$, there exists a map $[[\text{let $t$ be * in $c$}]] : \bigotimes \Xi, \Xi' \to C$ such that $[[\text{let * be * in $c$}]] = c$.
\end{defn}
This is trivially satisfied by every model by setting $[[I]] = I$, $[[*]] = 1_{I}$, and $[[\text{let $t$ be * in $c$}]]$ to the composite $\rho (c \otimes [[t]]) \alpha  : \bigotimes \Xi, \Xi' \cong \Xi \otimes \Xi' \to C \otimes I \cong C$, where $\rho$ is the right unitor for the monoidal structure of $\mathcal{L}_{\Gamma}$, and $\alpha$ is the isomorphism $\bigotimes \Xi, \Xi' \cong \Xi \otimes \Xi$. As for the identity $\rho(c \otimes 1_{I}) \alpha = c$, notice that $\alpha : \bigotimes \Xi \cong \Xi \otimes [[\cdot]] = \Xi \otimes I$ is given by $\rho^{-1}$, so we get $\rho (c \otimes 1_I) = c \rho$, from the naturality of $\rho$.\\
\begin{defn}
  A model of LDTT \textbf{supports $\otimes$-types}, if, for every $A, B \in \mathcal{L}_{\Gamma}$, there exists an object $[[A \otimes B]] \in \mathcal{L}_{\Gamma}$, such that for any arrows $a : \Xi \to A$, $b : \Xi' \to B$, there exists an arrow $[[(a \otimes b)]] : \bigotimes Xi, \Xi \to [[A \otimes B]]$ and for arrows $t : \Xi' \to [[A \otimes B]]$ and $c : \bigotimes \Xi \otimes A \otimes B \to C$, there exists an arrow $[[\text{let $x \otimes y$ be $t$ in $c : C$}]]$ such that $[[\text{let $x \otimes y$ be $a \otimes b$ in $c$}]] = c$.
\end{defn}
Again, it is not hard to see that there is a canonical interpretation of this in any model of LDTT sending $[[A \otimes B]]$ to $[[A]] \otimes [[B]]$. Some care is needed in order to always make sure contexts are left associated.\\
Similarly, one can define what it means for a model of LDTT to support $\multimap, \oplus, \&, \top$ and $0$. We may think of these conditions as corresponding to weak versions of internal homs, binary products and coproducts, and terminal and initial object of the fibers, that are stable under reindexing functors. Therefore, whenever the fibers of our model are monoidal closed, complete or cocomplete, we know that it supports the corresponding type formers. This is well established and not the focus of the interplay between linear and dependent types we explore here. For a more detailed treatment we refer the reader to \cite{mellies}.\\
What it means for a model of linear dependent type theory to \textit{support} $\Pi$-types is directly inhererited from the standard, non-linear case.
\begin{defn}A model of LDTT \textbf{supports $\Pi$-types} if, for all $A \in \mathcal{T}_{\Gamma}$, the induced functor $\pi_A^* : \mathcal{T}_{\Gamma} \to \mathcal{T}_{\Gamma.A}$ has a right adjoint $\Pi_A : \mathcal{T}_{\Gamma.A} \to \mathcal{T}_{\Gamma}$ satisfying the following Beck-Chevalley condition:\\
For all pullbacks in $\mathcal{C}$:
  \begin{equation}\label{pb-diag}
    \ti
    \Gamma.E \ar[d, "\pi_E"] \ar[r, "q_{E, E'}"] & \Delta.E' \ar[d, "\pi_{E'}"] \\
    \Gamma \ar[r, "f"] & \Delta
    \kz
  \end{equation}
inducing the following functors between fibers:
\[
  \begin{split}
    q^*_{E, E'} &: \mathcal{T}_{\Delta.E'} \to \mathcal{T}_{\Gamma.E}\\
    f^* &: \mathcal{T}_{\Delta} \to \mathcal{T}_{\Gamma}\\
    \Pi_E &: \mathcal{T}_{\Gamma.E} \to \mathcal{T}_{\Gamma}\\
    \Pi_{E'} &: \mathcal{T}_{\Delta.E'} \to \mathcal{T}_{\Delta}
  \end{split}    
\]
The canonical natural transformation $f^*\Pi_{E'} \to \Pi_{E}q^*_{E, E'}$ induced by the adjunction is a natural isomorphism.\\
\end{defn}
The Beck-Chevalley condition is in effect saying that substitution commutes with the $\Pi$-type. For example, if $E' = E[\bar t/\bar y]$, with the map $f^*$ representing the substitution $[\bar t/\bar y]$, then the Beck-Chevalley condition reads that for all $B \in \mathcal{T}_{\Gamma}$, we have $(\Pi_{x : E}B)[\bar t/\bar y] \cong \Pi_{x : E[\bar t/\bar y]}B[\bar t/\bar y]$.\\
As the rules $\Sigma$ contains one more eliminator than usual ($\Sigma$-E$_2$ in Figure \ref{sigmaPi}), one might wonder whether this requires additional conditions for the semantic type formers to ensure that these are well behaved with respect to the linear fibers. We will shortly see that this is not the case.
\begin{defn}A model of LDTT \textbf{supports $\Sigma$-types} if it satisfies the following:
  \begin{enumerate}
  \item For all $A \in \mathcal{T}_{\Gamma}$, the induced functor $\pi_A^* : \mathcal{T}_{\Gamma} \to \mathcal{T}_{\Gamma.A}$ has a left adjoint, $\Sigma_A$,
  \item such that for all pullbacks (as in \ref{pb-diag}), these satisfy the Beck-Chevalley condition, i.e. the natural transformation: $\Sigma_Eq^* \to f^*\Sigma_{E'}$ is a natural isomorphism, and
  \item the induced map $pair_{A,B} : \Gamma.A.B \to \Gamma.\Sigma_AB$ is an isomorphism
  \end{enumerate}
\end{defn}
The map $pair_{A, B} : \Gamma.A.B \to \Gamma.\Sigma_AB$ such that $\pi_{\Sigma_AB}pair_{A,B} = \pi_A\pi_B$, arises as the image of the unit $\eta : B \to \pi_A^*(\Sigma_AB)$ in $\mathcal{T}_A$ under the comprehension functor $\pi : \mathcal{T} \to \mathcal{C}^{\to}$. The inverse of the pairing map will be denoted $(pr_1, pr_2) : \Gamma.\Sigma_AB \to \Gamma.A.B$.\\
This structure is sufficient to support new elimination rule ($\Sigma$-E$_2$):
\begin{thm}
If a model of LDTT supports $\Sigma$-types, then for every object $C \in \mathcal{L}_{\Gamma.\Sigma_AB}$ and morphism $c : \Xi \to C\{pair_{A,B}\}$ in $\mathcal{L}_{\Gamma.A.B}$ and section $s : \Gamma \to \Gamma.\Sigma_AB$, there exists a morphism $\hat c_s : \Xi\{(pr_1, pr_2\} \to C\{s\}$ such that given sections $a : \Gamma \to \Gamma.A$ and $b : \Gamma.A \to \Gamma.A.B$, then $\hat c_{(a, b)} = c\{ba\} : \Xi\{ba\} \to C\{ba\}$.
\begin{proof}
  The situation is illustrated in the following diagram:
    \[
      \ti
      \Gamma.A.B \ar[d, "\pi_{A,B}"] \ar[r,"pair_{A,B}",swap] & \Gamma.\Sigma_AB \ar[l,"{(pr_1, pr_2)}",bend right,swap] \ar[dl, "\pi_{\Sigma_AB}"]\\
      \Gamma &
      \kz
    \]
Let $\hat c_s = c\{((pr_1, pr_2)s)\}$. First, this morphism has the correct target since we have
    \[
      C\{((pr_1,pr_2)s)\}\{pair_{A,B}\} = C\{(pair_{A,B}(pr_1,pr_2)s)\} = C\{s\}
    \]
    , relying on the fact our lax monoidal fibration is split. Secondly, we need to show that given sections $a : \Gamma \to \Gamma.A$ and $b : \Gamma.A \to \Gamma.A.B$, we have $c\{((pr_1,pr_2)(a, b))\} = c\{a\}\{b\}$:
    \[
      \{(pr_1,pr_2)(a, b)\} = \{(pr_1,pr_2)pair_{A,B}ba\} = \{ba\} = \{a\}\{b\}
    \]
  \end{proof}
\end{thm}
We may also speak of a model \textbf{supporting simple products}, which simply correspond to products in the fibers of $\mathcal{T}$ which are stable under reindexing functors. These are of course implied by if the model supports $\Sigma$-types.\\
When it comes to Id-types, the situation is not as fortunate. If one wants to keep the theory intensional, we need to add condition (3) to make sure that the semantic identity types satisfy the added elimination rules =-E$_2$ and =-E$_3$ in Figure \ref{id}.
\begin{defn}[Id-types]
  A model of LDTT \textbf{supports Id-types} if, for all $A \in \mathcal{T}_{\Gamma}$, there exists an object $Id_A \in \mathcal{T}_{\Gamma.A.A\{\pi_A\}}$ and a morphism $r_A : \Gamma.A \to \Gamma.A.A\{\pi_A\}.Id_{A}$ such that:
  \begin{enumerate}
    \item The following diagram commutes:
  \[
    \ti
    \Gamma.A \ar[d, "r_A"] \ar[rd, "v_A"]\\
    \Gamma.A.A\{\pi_A\}.Id_A \ar[r, "\pi_{Id_A}"] & \Gamma.A.A\{\pi_A\}
    \kz
  \]
\item For any commutative diagram:
  \[
    \ti
    \Gamma.A \ar[d, "r_A"] \ar[r] & \Delta.C \ar[d, "\pi_C"]\\
    \Gamma.A.A\{\pi_A\}.Id_A \ar[r] & \Delta
    \kz
  \]
  there exists a lift $J: \Gamma.A.A\{\pi_A\}.Id_A \to \Delta.C$ making the two triangles commute.
\item For any pair of objects, $C \in \mathcal{L}_{\Gamma.A.A^+.Id}$ and $\Xi \in \mathcal{L}_{\Gamma.A}$, sections $M, N : \Gamma \to \Gamma.A$, $P : \Gamma.A.A^+ \to \Gamma.A.A^+.Id$, and morphism $c : \Xi \to C\{r_A\}$, there exists morphisms $\hat c_{[M,N,P]}^1 : \Xi\{M\} \to C\{M\}\{N\}\{P\}$ and $\hat c_{[M, N, P]}^2 : \Xi\{N\} \to C\{M\}\{N\}\{P\}$ such that $\hat c_{[M,M,refl]}^1 = \hat c_{[M,M,refl]}^2 = c\{M\}$.
\end{enumerate}
\end{defn}
A simpler, but stronger condition, implying condition (3) in the intensional setting is that for every $A \in \mathcal{T}_\Gamma$, there is an adjunction $\pi_{A,Id}^* \dashv r^*$ between the fibers of $\mathcal{L}$. This yields for every $c : \Xi \to C\{r\}$, a morphism $\hat c : \Xi\{\pi_{A,Id}\} \to C$, which, given sections $M, N : \Gamma \to \Gamma.A$ and $P : \Gamma.A.A^+ \to \Gamma.A.A^+.Id$, we can send to $\hat c\{M\}\{N\}\{P\} : \Xi\{M\}\{N\}\{P\}\{\pi_{A,Id}\} \to C\{M\}\{N\}\{P\}$, where $\Xi\{M\}\{N\}\{P\}\{\pi_{A,Id}\} = \Xi\{M\}$ since $\pi_{A,Id}PN = 1_{\Gamma.A}$.

If one were to work within an extensional type theory, where the rule:
\[
  \inference{\Gamma \vdash p : a =_A b}{\Gamma \vdash a \equiv b : A}
\]
is added, then the third condition is not needed:
\begin{thm}A model of LDTT with extensional equality supports Id-types if, for every $A \in \mathcal{T}_{\Gamma}$, there are objects $Id_A \in \mathcal{T}_{\Gamma.A}$ satisfying condtions 1 and 2 above.
  \begin{proof}
    In extensional type theory, every identity term $\Gamma,x, y : A \vdash P : x =_Ay$ can be shown to be equal to reflexivity by forming the identity type:
    \[
      \Gamma,x,y: A, p : x=_Ay \vdash p =_{x=_Ax}refl(x) \type
    \]
    this is well typed, since by $\Gamma,x,y : A, p : x=_Ay \vdash p : x=_Ay$, we conclude the definitional equality $x \equiv y$, so the types $x=_Ay$ and $x=_Ax$ are definitionally equal. We can then inhabit the type $p =_{x =_Ax}refl(x)$ using the elimination principle from the equality $\Gamma,x : A, refl(x) : x=_Ax \vdash refl(refl(x) : refl(x) =_{x=_Ax}refl(x)$. Since we have inhabited the propositional equality, the equality holds judgementally by extensionality.\\
    Since we identify judgementally equal terms in our semantics, this implies that any section of $\pi_{A.Id} : \Gamma.A.A^+.Id \to \Gamma.A$ must be equal to $r_A : \Gamma.A \to \Gamma.A.A^+.Id$. Condition 3 then reads rather trivially that for any morphism $c : \Xi \to C\{r_A\}$ and section $M : \Gamma \to \Gamma.A$, there should exist a morphism $\hat c_{M} : Xi\{M\} \to C\{M\}\{r\}$ which we get by $\hat c_M = c\{M\}$.
  \end{proof}
\end{thm}
The semantic type formers for the linear dependent $\sqcap$ and $\sqsubset$ is akin to that of $\Pi$ and $\Sigma$. They are given by adjoints to the functors between fibers of $\mathcal{L}$ induced by the projection maps in $\mathcal{C}$.
\begin{defn}
  A model of LDTT \textbf{supports $\sqcap$-types} if, for all $A \in \mathcal{T}_{\Gamma}$, the induced monoidal functor $\pi_A^* : \mathcal{L}_{\Gamma} \to \mathcal{L}_{\Gamma.A}$ has a monoidal right adjoint, $\sqcap_A$ satisfying the following Beck-Chevalley condition:\\
  For all pullback squares in $\mathcal{C}$ of the following form:
  \[
      \ti
    \Gamma.E \ar[d, "\pi_E"] \ar[r, "q_{E, E'}"] & \Delta.E' \ar[d, "\pi_{E'}"] \\
    \Gamma \ar[r, "f"] & \Delta
    \kz
  \],
the canonical natural transformation $f^*\sqcap_{E'} \to \sqcap_{E}q^*_{E, E'}$ is a natural isomorphism.\\
\end{defn}
\begin{defn}
  It \textbf{supports $\sqsubset$-types} if, for all $A \in \mathcal{T}_{\Gamma}$, the functor every $\pi_A^*$ has a monoidal left adjoint, satisfying the following:
  \begin{enumerate}
  \item (Beck-Chevalley): For all pullbacks squares as above, the natural transformation $\sqsubset_Eq^* \to f^*\sqsubset_{E'}$ is a natural isomorphism.
  \item (Frobenius reciprocity): For all objects $\Xi \in \mathcal{L}_{\Gamma}$ and $B \in \mathcal{L}_{\Gamma.A}$, the canonical morphism $\sqsubset_A(\Xi\{\pi_A\} \otimes B) \to \Xi \otimes \sqsubset_AB$ is an isomorphism.
  \end{enumerate}
\end{defn}
To illustrate why these conditions form the appropriate semantic counterpart to the derivation rules, we will outline the case for $\sqsubset$ in detail.\\
For every object $B \in \mathcal{L}_{\Gamma.A}$, we get a type $\sqsubset_AB \in \mathcal{L}_{\Gamma}$, such that, given any section $s : \Gamma \to \Gamma.A$, and map $b : \Xi \to B\{s\}$ in $\mathcal{L}_{\Gamma}$, we get a map:
\[
  s^*\eta_B \circ b : \Xi \to B\{s\} \to s^*\pi_A^*(\sqsubset_AB) = \sqsubset_AB
\]
where $\eta_B : B \to \pi^*(\sqsubset_AB)$ is the unit of the adjunction.
This map is the interpretation of the term $(s, b)$ given by the introduction rule $\sqsubset$-I.\\
To interpret the elimination rule, we are given maps $t : \Xi \to \sqsubset_AB$ in $\mathcal{L}_{\Gamma}$ and $c : \Xi'\{\pi_A\} \otimes B \to C\{\pi_A\}$ in $\mathcal{L}_{\Gamma.A}$. By the adjunction, there exists a map $\hat c : \sqsubset_A(\Xi\{\pi_A\} \otimes B) \to C$ such that $\eta_{\Xi'\{\pi_A\}\otimes B}\circ \pi^*_A\hat c = c$. By the Frobenius reciprocity condition, we have an isomorphism: $\beta_{\Xi', B} : \Xi' \otimes \sqsubset_AB \to \sqsubset_A(\Xi\{\pi_A\} \otimes B)$, and we get a map:
\[
  \hat c \beta : \Xi' \otimes \sqsubset_AB \cong \sqsubset_A(\Xi'\{\pi_A\} \otimes B) \to C
\]
which we can precompose with $1_{\Xi'} \otimes t$ to get a map from $\Xi' \otimes \Xi$ to $C$. We can then precompose with an appropriate isomorphism $\alpha' : \bigotimes (\Xi', \Xi) \to \Xi' \otimes \Xi$ to get a map from $\bigotimes \Xi', \Xi$ to $C$, which will be the interpretation of the elimination term from the rule $\sqsubset$-E.\\
The computation rule boils down to showing that the following triangle commutes:
\[
  \ti
\{s\}(\Xi'\{\pi_A\}\otimes B) \ar[rd, "s^*c"] \ar[d,"s^*\eta_{(\Xi'\{\pi_A\}\otimes B)}",swap] & \\
s^*\pi_A^*\sqsubset_A(\Xi'\{\pi_A\} \otimes B) = \sqsubset_A(\Xi'\{\pi_A\} \otimes B) \ar[r,"\hat c"] & C
\kz
\]
which follows from applying the functor $s^*$ to the equality $\eta_{\Xi'\{\pi_A\}\otimes B}\circ \pi^*_A\hat c = c$.
\begin{defn}\label{semanticML}
  A model of LDTT which supports simple products \textbf{supports the operators $M$ and $L$} if there exists strong monoidal functors $M : \mathcal{L} \leftrightarrow \mathcal{T} : L$ which are cartesian with respect to the fibrations $p : \mathcal{T} \to \mathcal{C}$ and $q : \mathcal{L} \to \mathcal{C}$, such that the following conditions hold:
  \begin{enumerate}
    \item $L \dashv M$ is a fibred, monoidal adjunction
    \item For $A \in \mathcal{T}_\Gamma$ and morphisms $t : \pi^*_A(\Xi') \to \pi^*_A(B)$ in $\mathcal{L}_{\Gamma.A}$ and $y : \Xi \to L(A)$ in $\mathcal{L}_\Gamma$, there exists a morphism $e(y, t) : \Xi \otimes \Xi' \to B$ in $\mathcal{L}_\Gamma$, such that for any section $s : \Gamma \to \Gamma.A$, we have $e(L(\hat s),t) = s^*(t)$, where $\hat s \in \mathcal{T}(1, A)$ arises out of the section.
    \item The map $\pi^*_A(-) \circ (u \otimes 1_{\pi^*_A \Xi}) : \mathcal{L}_\Gamma(LA \otimes \Xi, B) \to \mathcal{L}_{\Gamma.A}(\pi^*_A(\Xi), \pi^*_A(B))$ is injective, where $u : I \to \pi^*_A(L_{\Gamma}A)$ corresponds to the image of the canonical $\hat {var_A} : 1 \to \pi^*_A(A)$ in $\mathcal{T}_{\Gamma.A}$ under $L$.
      \end{enumerate}
\end{defn}
Recall that a fibred adjunction implies that there are natural isomorphisms making the following diagram commute:
\[
  \ti
  \mathcal{L}_\Gamma  \ar[d, "\pi^{*(\mathcal{L})}_A"] \ar[r, "M_{\Gamma}", bend right] & \mathcal{T}_{\Gamma} \ar[l, "L_{\Gamma}", bend right] \ar[d, "\pi^{*(\mathcal{T})}_A"] \\
  \mathcal{L}_{\Gamma.A} \ar[r, "M_{\Gamma.A}", bend right] & \mathcal{T}_{\Gamma.A} \ar[l, "L_{\Gamma.A}", bend right]\\
  \kz
\]
which from a syntactic perspective ensures that $M$ and $L$ commute with substitution. This is how $u$ is constructed. We have a morphism $\hat {var_A} : \mathcal{T}_{\Gamma.A}(1, \pi_A^*(A))$ corresponding to the canonical section $var_A : \Gamma.A \to \Gamma.A.A^+$, so that $L(\hat {var_A}) : L(1) \to L_{\Gamma.A}\pi_A^*(A)$ corresponds to a $u : I \to \pi_A^*L_\Gamma(A)$ via the isomorphisms above and the fact that $L$ is strongly monoidal.\\
\begin{comment}
We can therefore get the map $u$ by translating $var_A : \Gamma.A \to \Gamma.A.A^+$ through the isomorphisms:
\[
\mathcal{C}_\Gamma(A, A.^+) \cong \mathcal{T}_{\Gamma.A}(1, \pi  \mathcal{T}_\Gamma(A, M_\Gamma L_\Gamma A) \cong \mathcal{T}_{\Gamma.A}(1, \pi^{(*)\mathcal{T}}_A(M_\Gamma L_\Gamma A)) \cong \mathcal{T}_{\Gamma.A}(1, M_{\Gamma.A}(\pi^{(*)\mathcal{L}}_A L_\Gamma A))) \cong \mathcal{L}_{\Gamma.A}(L(1), \pi^{*(\mathcal{L})}_AL_\Gamma A) \cong \mathcal{L}_{\Gamma.A}(I, \pi^{*(\mathcal{L})}_AL_\Gamma A)
\]
\end{comment}
Conditions 2 and 3 correspond to the elimination and computation rules for the $L$ operator respectively, and while they might appear somewhat unnatural semantically, they turn out to be hold in a large class of models, thanks to the following result:
\begin{thm}If the reindexing functors $\pi_A^*$ of the monoidal fibration $q : \mathcal{L} \to \mathcal{C}$ of a model of LDTT with unit are full and faithful, then any strong fibred monoidal adjunction $L \dashv M$ satisfies conditions 2 and 3.
  \begin{proof}
    Let $\phi_A : \mathcal{L}_{\Gamma.A}(\pi^*_A(E),\pi^*_A(D)) \to \mathcal{L}_\Gamma(E, D)$ be the inverse to the function induced on homsets by $\pi_A$. By sending the unique map from $\pi^*_A(A)$ to $1$ in $\mathcal{T}_{\Gamma.A}$ through the isomorphisms
    \[
      \mathcal{T}_{\Gamma.A}(\pi^*_AA,1) \cong \mathcal{T}_{\Gamma.A}(\pi^*_AA,M(I)) \cong \mathcal{L}_{\Gamma.A}(L_{\Gamma.A}\pi^*_AA,I) \cong \mathcal{L}_{\Gamma.A}(\pi^*_AL_{\Gamma}A,I)
    \]
    we get map $v : \pi^*_AL_\Gamma A \to I$. Using this, we define $e(y,t) = \phi_A(t \circ (v \otimes 1_{\pi^*_A(\Xi')})) \circ (y \otimes 1_{(\Xi')})$. Now, since any section $s : \Gamma \to \Gamma.A$ is also an inverse to the induced functor on homsets, it must be the same as $\phi_A$.
    \[
      \phi_A(t \circ (v \otimes 1_{\pi^*_A(\Xi')}))\circ (L(\hat s) \otimes 1_{(\Xi')}) = s^*(t) \circ (s^*(v)L(\hat s) \otimes 1_{\Xi'})
    \]
    But now $\hat s : \mathcal{T}_{\Gamma}(1, A)$ is obviously a section of the unique map from $A$ to $1$, so by naturality of ismorphisms above we have that $s^*(v)L(\hat s)$ is the identity.\\
    The situation for condition 3 is illustrated in the following diagram:

    Since the functors $\pi_A^*$ are strictly monoidal, we have $I = \pi_A^*(I)$ in $\mathcal{L}_{\Gamma.A}$, so we really have that for morphisms $s, t : LA \otimes \Xi \to B$:
    \[
      \begin{split}
      \pi_A^*(s) \circ (u \otimes 1_{\pi_A^* \Xi}) = \pi_A^*(t) \circ (u \otimes 1_{\pi_A^* \Xi}) =\\
      \pi_A^*(s \circ (\phi_A(u) \otimes 1_{\pi_A^* \Xi})) = \pi_A^*(t \circ (\phi_A(u) \otimes 1_{\pi_A^* \Xi})) \iff\\
      s \circ (\phi_A(u) \otimes 1_{\pi_A^* \Xi})) = t \circ (\phi_A(u) \otimes 1_{\pi_A^* \Xi})
     \end{split}
    \]
   

    The second part of the proof remains. What one really ought to do is to make sure that the syntactic interpretation of $L(f)$ overlaps with the semantic.
  \end{proof}
\end{thm}
\begin{comment}
For compatible $M$ and $L$, there is a natural map
\[
  f : \mathcal{L}_\Gamma(LA \otimes \Xi, B) \to \mathcal{L}_{\Gamma.A}(\pi^*_A\Xi, \pi^*_AB)
\]
In order to illustrate this, first . The canonical morphism
\[
  \beta \circ ! : \pi^{*(\mathcal{T})}_AA \to 1 \to M_{\Gamma.A}(I)
\]
in $\mathcal{T}_{\Gamma.A}$ gives rise to a map $L_{\Gamma.A}\pi^{*(\mathcal{T})}_AA \to I$, which we can transform into the map $\hat f : \pi^{*(\mathcal{L})}_AL_\Gamma A \to I$. Then, we can for any map
\end{comment}


There are various degrees to which a model can support universes. The baseline condition is an object $U$ in every fiber such there is an object in the same fiber for every section of the corresponding projection. In order to even state what it means for a universe to be closed under various types, we need to assume that our model supports such types.
\begin{defn}A model of LDTT \textbf{supports cartesian universes}, if for every $\Gamma \in \mathcal{C}$, there exists an object $U \in \mathcal{T}_{\Gamma}$, such that, for every section $t : \Gamma \to \Gamma.U$ to the corresponding projection, there exists an object $El(t) \in \mathcal{T}_{\Gamma}$. For a model that supports the type former in question, the universe is closed under this type if:
  \begin{itemize}
  \item $\Pi$-types (or $\Sigma$). For sections $t : \Gamma \to \Gamma.U$ and $v : \Gamma.El(t) \to \Gamma.El(t).U$, there is a section $\hat \Pi_{El(t)}v : \Gamma \to \Gamma.U$ such that $El(\hat \Pi_{El(t)}) = \Pi_{El(t)}El(v)$ (or $\Sigma$) i.e. if the object corresponding to $\hat \Pi_{El(t)}v$ is equal the image of $El(v)$ under the functor corresponding to the semantic type former.
  \item $Id$-types. For sections $A : \Gamma \to \Gamma.U$, $a, b : \Gamma \to \Gamma.El(A)$, there is a section $\hat Id(a, b) : \Gamma \to \Gamma.U$, such that $El(\hat Id(a, b)) = Id_A$.
  \end{itemize}
\end{defn}
Linear universes are defined in the same fashion, keeping in mind that the linear universe is a cartesian type.
\begin{defn}
  A model of LDTT \textbf{supports linear universes}, if, for every $\Gamma \in \mathcal{C}$, there is an object $L \in \mathcal{T}_{\Gamma}$, such that for every section $t : \Gamma \to \Gamma.L$ to the corresponding projection, there exists an object $El(t)$ in $\mathcal{L}_{\Gamma}$. For a model that supports the type former in question, the linear universe is closed under this type if:
  \begin{itemize}
    \item $I$, (or $\top$, $0$): There is a section $\hat I : \Gamma \to \Gamma.L$, (or $\top$, $0$) such that $El(\hat I) = I$ in $\mathcal{L}_\Gamma$.
    \item $\otimes$ (or $\multimap$, $\&$): For every pair of sections $a, b : \Gamma \to \Gamma.L$, there is a section $\hat{a\otimes b}$ (or $\hat \multimap$, $\hat \&$) such that $El(\hat{a\otimes b}) = El(a)\otimes El(b)$
    \end{itemize}
  \end{defn}
  \begin{defn}
    Given a model supporting both cartesian and linear universes, these are closed under:
    \begin{itemize}
    \item $M$, if, for every section $x : \Gamma \to \Gamma.L$, there exists an element $\hat M(x) : \Gamma \to \Gamma.U$ such that $El(\hat M(x)) = M(El(x))$.
    \item $L$, if, for every section $x : \Gamma \to \Gamma.U$, there exists an element $\hat L(x) : \Gamma \to \Gamma.L$ such that $El(\hat L(x)) = L(El(x))$.
    \item $\sqcap$ (or $\sqsubset$), if, for sections $t : \Gamma \to \Gamma.U$ and $s : \Gamma.El(t) \to \Gamma.El(t).L$, there exists a section $\hat \sqcap_{El(t)}s : \Gamma \to \Gamma.L$ (or $\hat \sqsubset$), such that $El(\hat \sqcap_{El(t)}s) = \sqcap_{El(t)}El(s)$.
    \end{itemize}
\end{defn}


\newpage
\section{Models}
\subsection{Set indexed families}
Our first model will be based on the standard set-theoretic interpretation of dependent type theory \cite{hofmann1997syntax}. The extension of this model to the linear realm is fairly straightforward, and provides a good springboard for examples to come. (It is also sufficient for showing that linear dependent type theory is a proper generalisation of both dependent type theory and linear type theory, as outlined in \cite{vakar14}.)

Our linear and cartesian fibrations will both be constructed as fibrations of set indexed families:
\begin{defn}[$Fam(\mathcal{C})$]
For an arbitrary category $\mathcal{C}$, let $Fam(\mathcal{C})$ denote the category whose objects consists of pairs $(S, f)$ where $S$ is a set and $f$ is a function $f : S \to Ob(\mathcal{C})$. Morphisms of $Fam(\mathcal{C})$ are pairs $(u, \alpha) : (S, f) \to (S', g)$ where $u : S \to S'$ and $\alpha : S \to \text{Mor}(\mathcal{C})$ such that $\alpha(s) : f(s) \to g(u(s))$ for all $s \in S$. Composition is given, for two compatible morphisms $(u, \alpha)$ and $(v, \beta)$, by:
\[
(v, \beta) \circ (u, \alpha) = (v \circ u, g(u(s)) \circ f(s))
\]
for all $s \in S$.
\end{defn}
By projecting a family to its indexing set, we get a fibration $p : Fam(\mathcal{C}) \to \mathbf{Set}$, and if $\mathcal{C}$ has a terminal object, $\top$ such that the hom-sets $\mathcal{C}(\top,A)$ are small for all $A \in \mathcal{C}$, we can form a comprehension category by defining $\pi : Fam(\mathcal{C}) \to \mathbf{Set}^\to$ as follows.

On objects, let
\[
\pi(S, f) = fst: \{(s, t) \; | \; s \in S, t : \top \to f(s)\} \to S
\]
For a morphism $(u, \alpha) : (S, f) \to (S', g)$, let
\[
q_{(u,\alpha)} : \{(s, t) \; | \; s \in S, t : \top \to f(s) \} \to \{(s', t') \; | \; s' \in S', t' : \top \to g(s') \}
\]
be defined by $q_{(u, \alpha)}(s, t) = (u(s), \alpha(s) \circ t)$. The functor $\pi$ sends morphisms $(u, \alpha)$ to squares:
\[
\ti
\{(s, t) \; | \; s \in S, t : \top \to f(s) \} \ar[r, "q_{(u, \alpha)}"] \ar[d, "fst"]& \{(s', t') \; | \; s' \in S', t' : \top \to g(s') \} \ar[d, "fst"]\\
I \ar[r, "u"] & J
\kz
\]
in $\mathbf{Set}$. This comprehension category will be full if the global sections functor $\mathcal{C}(\top, -) \to \mathbf{Set}$ is full and faithful.
\\
For a morphism $u : S \to p(S', f) = S'$ the canonical choice of a lift $u^* = (u, i) : (S, fu) \to (S', f)$ where $i : S \to \text{Mor}(\mathcal{C})$ is defined by $s \mapsto 1_{fu(s)}$ makes this a split fibration.\\
The cartesian part of our semantic structure will simply be the fibration $p : Fam(\mathbf{Set}) \to \mathbf{Set}$ with $\pi : Fam(\mathbf{Set}) \to \mathbf{Set}^\to$ as outlined above. Then for any symmetric monoidal category $\mathcal{V}$ we form a split monoidal fibration by letting the unit object be given at any fiber by mapping a set $S$ to the family constant at the unit of $\mathcal{V}$, and define the tensor product as:
\[
(S, g) \otimes (S, f) = (S, f \otimes g) = (S, \lambda s. f(s) \otimes g(s))
\]
For $u : S \to p(S', f) = S'$ in the base, we have:
\[
  u^*((S', \alpha) \otimes (S', \beta)) = (S, \lambda s.\alpha u(s) \otimes \beta(u(s))) = u^*(S', \alpha) \otimes u^*(S', \beta)
\]
so this is in fact a split monoidal fibration. Putting this together, this forms our first concrete model of the type theory:
\[
\ti
Fam(\mathcal{V}) \ar[rd, "q"]  & Fam(\mathbf{Set}) \ar[d, "p"] \ar[r, "\pi"] & \mathbf{Set}^\to \ar[ld, "cod"] \\
& \mathbf{Set}
\kz
\]
This model trivially supports $\otimes$ and $I$-types (all models do). For any fibration $p : Fam(\mathcal{C}) \to \mathbf{Sets}$, its fiberwise limits and colimits are constructed pointwise, so they exist if and only if they do in $\mathcal{C}$. Since reindexing functors is simply precomposition, they preserve these (co)limits We therefore get that the families model supports the type formers $\multimap, \oplus, 0, \&$ and $\top$ if $\mathcal{V}$ if is monoidal closed, has binary coproducts, initial object, binary products and terminal object respectively. \\
For the dependent types, we utilize the following result:
\begin{thm}
For a fibration $p : Fam(\mathcal{C}) \to \mathbf{Sets}$ and a function $u : S \to S'$ in the base, $u^* : Fam(\mathcal{C})_{S'} \to Fam(\mathcal{C})_S$ has a left (right) adjoints if and only if $\mathcal{C}$ has small coproducts (products).
  \begin{proof}
    For $\mathcal{C}$ with small coproducts, define the left adjoint to $u^*$ by $(S, f) \mapsto (S', \lambda s'.\coprod_{s \in u^{-1}(s')}f(s))$. Similarly for $\mathcal{C}$ with small products, define a right adjoint to $u^*$ by $(S, f) \mapsto (S', \lambda s'.\prod_{s \in u^{-1}(s')}f(s))$.\\
    In the other direction, the set of objects we want to take the (co)product of forms an object $(S, f)$ of $Fam(\mathcal{C})$. From the unique map $! : S \to 1$ in the base, we get a left (right) adjoint to the lift of $!$, which sends $(S, f)$ to an object of $Fam(\mathcal{C})_1 \cong \mathcal{C}$, which has the universal property of the (co)product of the objects indexed by $S$:
    \[
      Hom_{\mathcal{C}}(\Sigma_A(S, f), B) \cong Hom_{Fam{\mathcal{C}}_S}((S, f), (S, B ))
    \]
    TODO: CHECK THIS DIRECTION AGAIN (WHEN AWAKE)
  \end{proof}
\end{thm}
From this we see that the families model supports $\Sigma$ and $\Pi$ types, since $\mathbf{Sets}$ has all limits and colimits, and that it supports $\sqcap$ (or $\sqsubset$) if and only if $\mathcal{V}$ has small products (or coproducts).\\
M and L through global sections functor?\\
Universes as the underlying set of objects?
\subsection{Syntactic enriched categories}
As an in depth example construction in the families model of linear dependent type theory, recall the notion of an enriched category in as defined in \ref{enr-cat}.
Our goal is to construct a syntactic analogue of this construction in the families model, such that the interpretation of this is an enriched category. There are two ways of doing this. The first is a meta construction, in which we ask for the existence of certain types and judgemental equalities to hold, whereas the second, internal definintion, is a type \textbf{Enr-Cat}, whose terms are interpreted as enriched categories. The type \textbf{Enr-Cat} allows us to formulate theorems about enriched categories directly in the syntax, but requires more involved type formers, such as universes, and the following type,
with which we can reason (non-linearly) about the hom-sets of $\mathcal{V}$:\\
\fbox{
\begin{minipage}{.5\linewidth}
  \[
    \inference{\Gamma \vdash A \linear \quad \Gamma \vdash B \linear}
    {\Gamma \vdash [A, B] \type}[hom-F]
  \]
  \[
    \inference{\Gamma; x : A \vdash t : B}
    {\Gamma \vdash [\lambda x. t] : [A, B]}[hom-I]
  \]
\end{minipage}
\begin{minipage}{.5\linewidth}
  \[
    \inference{\Gamma \vdash f : [A, B] \quad \Gamma; \Xi \vdash a : A}
    {\Gamma; \Xi \vdash f(a) : B}[hom-E]
  \]
  \[
    \inference{\Gamma; x : A \vdash t : B \quad \Gamma; \Xi \vdash a : A}
    {\Gamma; \Xi \vdash [\lambda.x.t](a) \equiv t[a/x] : B}[hom-C]
  \]
\end{minipage}
}
In the presence of linear function types ($\multimap$) and the $M$-functor, this type can be just as well be constructed as $(A \multimap B)_M$. However, adding it as a primitive allows us to talk about the hom-sets of $\mathcal{V}$ even when it is not closed. Instead, the semantics of $[-, -]$ will be an object in $\mathcal{T}$ which ``represents'' the morphisms of $\mathcal{L}$:
\begin{defn}
  A model of linear depenendent type theory supports $[-,-]$-types, if, for all objects $A, B \in \mathcal{L}_{\Gamma}$, there exists an object $T[A, B] \in \mathcal{T}_{\Gamma}$ such that $\mathcal{T}_{\Gamma}(X, T[A, B]) \cong \mathcal{L}_{\Gamma.X}(A, B)$.
\end{defn}

\begin{defn}[meta-theoretic enriched categories]
  A meta-theoretic $\mathcal{V}$-enriched category in a context $\Gamma$ consists of the following data:
 \begin{itemize}
\item A (cartesian) type $\Gamma \vdash A \type$,
\item for any $x, y : A$, a linear type $\Gamma, x, y : A \vdash B_{x, y} \linear$,
\item terms $\Gamma, x, y, z : A; g: B_{y, z}, f:  B_{x, y} \vdash M(g, f) : B_{x, z}$,
\item $\Gamma, x : A; \cdot \vdash j_x : B_{x, x}$ and
\item judgemental equalities $\Gamma, x, y : A; f : B_{x, y} \vdash f \equiv M(j_y \otimes f)$ and $\Gamma, x, y : A; f : B_{x, y} \vdash f \equiv M(f \otimes j_x)$.
\end{itemize}
\end{defn}
The interpretation of this in the families model are precisely $\mathcal{V}$-enriched categories. The underlying set of objects will be $[[A]]$, the interpretation of $B$ is a function $B : [[A]] \times [[A]] \to \mathcal{V}$, which for each pair $x, y \in A$ assigns an object of $\mathcal{V}$. 
\begin{defn}[Internal enriched categories]
  The type \textbf{Enr-cat} is defined as
  \[
    Enr-Cat :\equiv \Sigma_{A : \mathcal{U}} \Sigma_{B : \Pi_{x, y : A}\mathcal{L}} \Sigma_{M : \Pi_{x, y, z : A} [B_{y, z} \otimes B_{x, y}, B_{x,z}]} \Sigma_{j : \Pi_{x: A}[I, B_{x, x}]}[\lambda f. f] = [\lambda f. M_{x, x, y}(f \otimes j_x)] \times [\lambda f. f] = [\lambda f. M_{x, x, y}(j_y \otimes f)] \\
  \]
\end{defn}
Since $Fam(\mathbf{Set})$ is an extensional model, whenever the $a =_A b$ is inhabited, we have $[[a]]=[[b]]$. Furthermore, since the equalities $p$, $q$ and $r$ are all identifying morphisms in the image of the faithful functor $M$, we have:
\[
[[f \circ 1_x ]] \equiv [[1_y \circ f]] \equiv [[f]]
\]
and
\[
[[h \circ (g \circ f)]] \equiv [[(h \circ g) \circ f]]
\]
for all $f : B_{x,y}$, $g : B_{y,z}$ and $h : B_{z,w}$, demonstrating that composition is unital and associative in the enriched category.
For example, we may choose $\mathcal{V}$ to be the category of groups equipped with the usual tensor product of groups. Here the $L$ functor forms the free abelian group of a set, and the construction above will yield an Ab-enriched category.
\subsection{Diagrams}
Expanding upon the Monoidal Families example given by Vakar \cite{vakar14}, we consider diagrams $J : \mathcal{D} \to \mathcal{V}$ of any shape in a category $\mathcal{V}$. In other words, we construct a category $\diag(\mathcal{V})$ whose objects are functors with $\mathcal{V}$ as codomain and whose morphisms for diagrams $J : \mathcal{D} \to \mathcal{V}$ and $J' :\mathcal{C} \to \mathcal{V}$ are given by functors $F : \mathcal{C} \to \mathcal{D}$ such that $J \circ F = J'$.

From this we get the obvious domain fibration $dom : \diag(\mathcal{V}) \to \textbf{Cat}$.
\begin{thm}
If $\mathcal{V}$ is a monoidal category, $dom$ is a lax monoidal fibration.
\begin{proof}
\end{proof}
\end{thm}
This suggests that we can get a model for linear dependent type theory by letting $\mathcal{L} = \diag(\mathcal{V})$ in the semantic structures given above. But what about the choice of $\mathcal{T}$? One can trivially choose $\mathcal{T} = \mathbf{Cat}$ to get the following picture:
\[
\ti
\diag(\mathcal{V}) \ar[rd, "dom"]  & \mathbf{Cat} \ar[d, "1_{\mathbf{Cat}}"] \ar[r, "Id"] & \mathbf{Cat}^\to \ar[ld, "cod"] \\
& \mathbf{Cat}
\kz
\]
where $Id : \mathbf{Cat} \to \mathbf{Cat}^\to$ is the map sending a category to its identity functor. Another choice would be $\mathcal{T} = \mathbf{Fib}$, the category of grothendieck fibrations, yielding:
\[
\ti
\diag(\mathcal{V}) \ar[rd, "dom"]  & \mathbf{Fib} \ar[d, "Base"] \ar[r, "\mathcal{P}"] & \mathbf{Cat}^\to \ar[ld, "cod"] \\
& \mathbf{Cat}
\kz
\]
where $Base$ is the morphism sending a fibration $p : E \to B \mapsto B$ and $\mathcal{P}$ sends a fibration $p : E \to B$ to its underlying functor $p : E \to B$. For any functor $F : A \to B$ in $\mathbf{Cat}$, there is a pullback:
\[
\ti
A \times_{B} E \ar[r] \ar[d, "F^*(p)"] & E \ar[d, "p"] \\
A \ar[r, "F"] & B
\kz
\]
where $F^*(p)$ is a fibration if $p$ is, by Lemma(Prop 2.6 in comprehension categories). This shows that $\mathcal{P}$ sends cartesian arrows to cartesian arrows. READ EXAMPLE 4.6 in Comprehension cats

One could also restrict $\diag(\mathcal{V})$ to diagrams in $\mathcal{V}$ over groupoids. In that case, $\mathcal{T}$ consists of fibrations of groupoids and the cartsian fragment of the type theory is essentially the groupoid model as presented by Hofmann and Streicher in \cite{hofmann1998}. This suggests that this model can serve as a setting for linear dependent homotopy type theory.
\newpage
The comprehension of $A \in [\Gamma, \mathbf{Gpd}]$ is the comma groupoid $(\Gamma \downarrow A)$, where objects are functors $F : \Gamma \to A(B)$ for some $B \in \Gamma$, and arrows are commutative diagrams:
\[
  \ti
  \Gamma \ar[r, "F"] \ar[rd, "G"] & A(B) \ar[d, "A(f)"]\\
  & A(C)
  \kz
\]
where $B, C$ are objects of $\Gamma$ and $f : B \to C$.\\
If the functor $\mathcal{V}(I, -) : \mathcal{V} \to \mathbf{Set}$ has a left adjoint $F$, then there exists an adjunction $M$ and $L$ for every $\Gamma$, arising from:
\[
  \ti
  \mathbf{Gpd} \ar[r, "\pi_0", bend left] & \mathbf{Set} \ar[l, "\delta", bend left] \ar[r, "F", bend left] & \mathcal{V} \ar[l, "{\mathcal{V}(I, -)}", bend left]
  \kz
\]
\begin{thm}The induced functor $\pi_A^*$ is full and faithful.
\end{thm}


\begin{thm}[Diag model M and L support.]
  If $\mathcal{V}$ is concrete (i.e. left adjoint to $\mathcal{V}(I, -)$), then there is an adjoint monoidal fibration $M : [\Gamma \mathbf{Gpd}] \leftrightarrow [\Gamma, \mathcal{V}] : L$ over every fiber, such that for any groupoid $\Gamma$ and functors $A \in [\Gamma, \mathbf{Gpd}]$, $\Xi, B \in [\Gamma, \mathcal{V}]$, there is an isomorphism:
  \[
    \mathcal{L}_{\Gamma}(LA \otimes \Xi, B) \cong \mathcal{L}_{\Gamma.A}(\pi_A^*(\Xi), \pi^*(B))
  \]
\end{thm}

\newpage
We expand this to a functor $\text{Diag}(\mathcal{V}) : \mathbf{Cat}^{op} \to \mathbf{SMCat(-,V)}$ where $\mathcal{C} \xrightarrow{F} \mathcal{D}$ in \textbf{Cat} induces a monoidal functor $[\mathcal{D}, \mathcal{V}] \xrightarrow{(-) \circ F} [\mathcal{C}, \mathcal{V}]$. To highlight the connection to the type theory, we let $A\{F\}$ in  $\diag(\mathcal{V})(\mathcal{C})$ denote the image of any object $A \in \diag(\mathcal{V})(\mathcal{D})$ under this functor. Notice that for any category $\mathcal{C}$, the functor category $[\mathcal{C}, \mathcal{V}]$ naturally carries a monoidal structure by $(F \otimes G)(c) = F(c) \otimes G(c)$, with the constant functor at the unit object $I \in \mathcal{\Ob(V)}$ as unit. This functor will also be denoted $I$.
\begin{thm}[Comprehension in $\diag(\mathcal{V})$]
$Diag(\mathcal{V})$ admits a comprehension. In other words, for any diagram $J : \mathcal{D} \to \mathcal{V}$ there is a representating object $\mathcal{D}.J \xrightarrow{\mathbf{p}_{\mathcal{D}.J}} \mathcal{D}$ in $\mathbf{Cat}_{/\mathcal{D}}$ such that for any morphism $F : \mathcal{C} \to \mathcal{D}$, we have $\diag(\mathcal{V})(\mathcal{C})(I, J\{F\}) \cong \mathbf{Cat}_{/\mathcal{D}}(F, \mathbf{p}_{(\mathcal{D}, J)})$.
\begin{proof}
Let $\mathcal{D}.J$ be given by the slice category $(I \downarrow J)$, whose objects are pairs $(d, j)$, with $d \in \mathcal{D}$, $j \in \Hom(I,J(d))$ and whose morphisms are $f : d \to d'$ such the following diagram commutes:
\[
\ti
I \ar[r, "j"] \ar[rd, "j'"] & J(d) \ar[d,"J(f)"]\\
& J(d')
\kz
\]
Compare this with natural transformations $\eta \in \diag(\mathcal{V})(\mathcal{C})(I, J\{F\}))$. For all objects $c, c' \in \mathcal{C}$ with morphism $c \xrightarrow{f} c'$ we require components $n_{\bullet} : I \to J \circ F(\bullet)$ such that the following diagram commutes:
\[
\ti
I \ar[r, "\eta_c"] \ar[rd, "\eta_{c'}"] & J(F(c)) \ar[d,"J(F(f))"]\\
& J(F(c'))
\kz
\]
Let $p_{\mathcal{D}.J} : (I \downarrow J) \to \mathcal{D}$ be the obvious forgetful functor, $(d, j) \mapsto d$. Now any functor $G : \mathcal{C} \to (I \downarrow J)$ such that $p_{\mathcal{D}.J}G = F$, must be of the form:
\[
\begin{split}
G(c) &= (F(c), g_c)\\
G(f) &= F(f)
\end{split}
\]
where $g_c : I \to F(c)$ is some morphism satisfying the commutativity conditions above. This uniqely defines a natural transformation $g \in \diag(\mathcal{V})(\mathcal{C})(I, J\{F\})$. Furthermore, for any natural transformation $\eta \in \diag(\mathcal{V})(\mathcal{C})(I, J\{F\}$, there is a corresponding functor $\hat \eta : \mathcal{C} \to (I \downarrow J)$ mapping $c \mapsto (F(c), \eta_c)$.
\end{proof}
\begin{lemm}
For any groupoid $G$ and functor $A \in [G, \mathcal{V}]$ the comma category $(I \downarrow A)$ is a groupoid, and its associated projection $p_{G.A} : (I \downarrow A) \to G$ is a fibration.
\begin{proof}
A morphism between objects $(g, i)$, $(g', i')$ in $(I \downarrow A)$ are given by a morphism $f : g \to g'$ in $G$ such that $A(f) \circ i = i'$. Since $G$ is a groupoid there exists an inverse $f^{-1}$. That this map yields an inverse of $(I \downarrow A)$ is immediate from the fact that the following diagram in $\mathcal{V}$ commutes:
\[
\ti
I \ar[rd,"i'",swap] \ar[r, "i"] & A(g) \ar[d, "A(f)", bend right,swap] \\
& A(g') \ar[u, "A(f^{-1}) = A(f)^{1}", bend right,swap]
\kz
\]
To see that $p$ is a fibration, let $(g, i)$ be an object of $(I \downarrow A)$ and $f : g \to g'$ an arrow in $G$. Then the object $(g', A(f)\circ i)$ together with $f$ seen as a morphism of $(I \downarrow A)$ form an immediate commutative diagram in $\mathcal{V}$.
\end{proof}
\end{lemm}
\begin{corl}
The restriction of $\diag(\mathcal{V})$ to the category of groupoids is also a model for IDLTT.
\end{corl}

\end{thm}
The functor $p_{\mathcal{D}.J}$ will sometimes be referred to as the \textbf{projection} associated to $J$.
Recall that a model $\mathcal{C}, \mathcal{L}$ of ILDTT \textbf{supports $\Sigma$-types} if $\mathcal{L}(p_{\Delta.A})$ has a left adjoint for all $\Delta \in \mathcal{C}$, and $A \in \mathcal{L}(\Delta)$. It \textbf{supports $\Pi$-types} if all $\mathcal{L}(p_{\Delta.A})$ have right adjoints.
In the $Diag(V)$ model, $\Sigma$- and $\Pi$-types are left and right adjoints to the functor $p_* : [\Delta, \mathcal{V}] \to [\Delta.A, \mathcal{V}]$ induced by the projection $p_{\Delta.A} : \Delta.A \to \Delta$. These are precisely the left and right Kan extensions along $p_{\Delta.A}$.
\begin{defn}[coCartesian morphism]
Given a functor $p : E \to B$, an arrow $f : e_1 \to e_2$ is coCartesian with respect to $p$ if, for any pair of morphisms $h : e_1 \to e_3$ and $g : p(e_2) \to p(e_3)$ as in the following commutative diagram:
\[
\ti
p(e_1) \ar[r, "p(f)"] \ar[rd, "p(h)"] & p(e_2) \ar[d, "g"] \\
& p(e_3)
\kz
\]
there exists a unique morphism $\hat g : e_2 \to e_3$ such that $p(\hat g) = g$ and $\hat g f = h$.
\end{defn}
\begin{lemm}{unique-target}
For a functor $p : E \to B$ and $f_1 : e_1 \to e_2$, $f_2 : e_1 \to e_3$ two coCartesian morphisms such that $p(f_1) = p(f_2) = \alpha : b_1 \to b_2$, there is a unique isomorphisms $\phi : e_2 \to e_3$ such that the following diagram commutes:
\[
\ti
e_1 \ar[d, "f_1"] \ar[rd, "f_2"] & \\
e_2 \ar[r,"\phi"] &  e_3
\kz
\]
\begin{proof}
Since $f_1$ coCartesian, the composition $Id_{b_2} \circ p(f_1) = p(f_2)$ has a unique lift $\phi : e_2 \to e_3$ in $E$ such that $\phi f_1 = f_2$. Similarly, there is a unqie morphism $\psi : e_3 \to e_2$ such that $\psi f_2 = f_1$. Composing, we get an arrow $\psi \phi f_1 = f_1$. But since we also have $Id_{b_2} \circ p(f_1) = p(f_1)$, the only arrow $\pi : e_2 \to e_2$ such that $\pi f_1 = f_1$ must be the identity on $e_2$, so $\phi$ is a isomorphism.
\end{proof}
\end{lemm}
\begin{defn}[Opfibration]
A functor $p : E \to B$ is an \textbf{opfibration} if for every $e_1 \in E$ and arrow $\alpha : p(e_1) \to b$ in the base $B$, there exists a coCartesian arrow $f : e_1 \to e_2$ in $E$ such that $p(f) = \alpha$.
\end{defn}
Given such a fibration, for any object $b \in B$, the objects and morphisms of $E$ that are mapped to $b$ and its identity morphism via $p$ form a category, $E_b$, called the $\textbf{fiber}$ over $b$. From any map $f : b \to b'$ in the base we can construct a functor $\hat f : E_b \to E_{b'}$ by sending $e \in E_b$ to the target of a corresponding coCartesian lift $g : e \to e'$. By the previous lemma, such a functor $\hat f$ will be unique up to unique isomorphism.
\begin{thm}
Given a category $\mathcal{C}$ and functor $A : \mathcal{C} \to \mathcal{V}$, the projection $p : (v \downarrow A) \to \mathcal{C}$ is an opfibration for any $v \in \mathcal{V}$.
\begin{proof}
Let $(c, j: v \to A(c))$ be an object of $(v \downarrow A)$ and $f: c \to c'$ a morphism in $\mathcal{C}$. Then $f$ induces a morphism of between $(c, j)$ and $(c', fj)$ in $(v \downarrow A)$. For any pair of morphisms $h : (c, j) \to (c'', j'')$ and $g : c' \to c''$ such that the following diagram commutes:
\[
\ti
c \ar[r, "f"] \ar[rd, "h"] & c' \ar[d, "g"]\\
& c''
\kz
\]
we have the following commutative diagram in $(v \downarrow A)$:
\[
\ti
& c \ar[d, "f"] \ar[dd, "h", bend left]\\
v \ar[ru, "j"] \ar[rd, "j''"] \ar[r, "f j'"]& c' \ar[d, dotted, "g"]\\
& c''
\kz
\]
Furthermore, since morphisms in $(v \downarrow A)$ arise from morphisms in $\mathcal{C}$, $g$ is the unique candidate.
\end{proof}
\end{thm}
\begin{thm}
Let $p : \mathcal{C} \to \mathcal{D}$ be an opfibration and $\mathcal{V}$  cocomplete. Then there exists a functor $Lan_p : [\mathcal{C}, \mathcal{V}] \to [\mathcal{D}, \mathcal{V}]$ which is a left kan extension of $p$.
\begin{proof}
For any functor $Y \in [\mathcal{C}, \mathcal{V}]$, let $Lan_p(Y)$ be given by:
\[
\begin{split}
Lan_p(Y)(d) &:= \lim_{\to}(\mathcal{C}_d \hookrightarrow \mathcal{C} \xrightarrow{Y} \mathcal{V})\\
\end{split}
\]
The action of $Lan_p(Y)$ on morphisms $f : d \to d'$, arises from the universal mapping property of the colimits. Specifically, one can distinguish between two cases. If $d$ is not in the image of $p$, then $Lan_p(Y)(d)$ is the initial object in $\mathcal{V}$ and $Lan_p(Y)(f)$ the unique morphism from it. Otherwise, let $p(c) = d$ for some $c \in \mathcal{C}$ and $\hat f : c \to c'$ be a cocartesian arrow such that $p(\hat f) = f$. We want to show that $Lan_p(Y)(d')$ forms a cocone of the diagram to which $Lan_p(Y)(d)$ is a limit. To that end, let $g : c \to c''$ be an arbitrary morphism in $\mathcal{C}_{d}$. We have the following image:
\[
\ti
Y(c) \ar[r, "\lambda_{Y(c)}"] \ar[dd, "Y(\hat f)",swap, bend right] \ar[d, "Y(g)"]  & Lan_p(Y)(d) \\
Y(c'')  \ar[ru, "\lambda_{Y(c')}"]  \\
Y(c') \ar[r, "\lambda_{Y(c'')}", swap] & Lan_p(Y)(d') \
\kz
\]
But there should also exist a cocartesian arrow $\hat g$ corresponding to $1_d : p(c) \to p(c'')$, so from the following diagram in $\mathcal{D}$:
\[
\ti
p(c) = d \ar[d, "p(\hat f) = f",swap] \ar[r, "p(\hat g) = 1_d"] & p(c'') = d\ar[ld, "f"] \\
p(c') = d'
\kz
\]
there must exist a unique arrow $f' : c'' \to c'$ such that $p(f') = f$ and $f' \hat g = \hat f$. This implies that $Lan_p(Y)(d')$ forms a cocone over the diagram in question, so we can define the $Lan_p(Y)(f)$ to be the unique map $Lan_p(Y)(d) \to Lan_p(Y)(d')$.
The action of $Lan_p$ on natural transformations $\epsilon : Y \to Z$ is similarly induced by the UMP of the colimits at each component.
\\
We show  $Lan_p \dashv p_*$ by exhibiting the unit $\eta :  1_{[\mathcal{D}, \mathcal{V}]} \to Lan_pp_*$ with the following universal property. For objects $Y \in [\mathcal{C}, \mathcal{V}]$, $X \in [\mathcal{D}, \mathcal{V}]$ and morphism $f : Y \to X \circ p$ there is a unique morphism $g : Lan_p(Y) \to X$  such that the following diagram commutes:
\[
\ti
Y \ar[d, "\eta_Y"] \ar[rd, "f"]\\
Lan_p(Y) \circ p \ar[r, "p*(g)"] &  X \circ p
\kz
\]
Again, $g$ arises from the universal property of the colimit: For a given $d \in \mathcal{D}$, all $c \in \mathcal{C}$ such that $p(c) = d$ are mapped to the same object by $X \circ p$, so $X \circ p(c)$ forms a cocone over the diagram $\mathcal{C}_{p(c)} \hookrightarrow \mathcal{C} \xrightarrow{Y} \mathcal{V}$. But $Lan_p(Y)(p(c))$ is the colimit of that diagram, so the $g$ arises from the unique map from the colimit to the cocone.
\end{proof}
\end{thm}
Dually, we can use the same argument to conclude that when $\mathcal{V}$ has all limits, the right Kan extension along $p$ exists.
\begin{cor}
If $\mathcal{V}$ has all colimits, then $\diag(\mathcal{V})$ supports $\Sigma$-types. If $\mathcal{V}$ has all limits, then $\diag(\mathcal{V})$ supports $\Pi$-types.
\end{cor}
\subsection{Spectra}
%\subsection{Monoidal groupoids}
%Given any bicategory $\mathcal{B}$, there is a monoidal groupoid $End(b)$ of endomorphisms of an object $b \in \mathcal{B}$ with 1-cells $f : b \to b$ as objects and invertible 2-cells $\eta : f \implies f'$ as morphisms. The monoidal structure of $End(b)$ is given by composition: $f \otimes f' = f'\circ f$. In particular, if $\mathcal{B} = \mathbf{Cat}$, then we have $End(\mathcal{C})$ a monoidal groupoid consisting of functors and natural isomorphisms.\\

\newpage


\section{Ideas}
H-spaces generalized to the tensor product?
\subsection{Dependent ordered type theory}
If one were to drop exchange as a structural rule, this should correspond to dropping the requirement of the semantic category being symmetric. A particular construction which might be interesting to explore in this setting would be simplicial sets equipped with the join. Would this work?
\nocite{benton1995mixed}
\nocite{hofmann1997syntax}
\bibliographystyle{plain}
\bibliography{refs.bib}
\end{document}

